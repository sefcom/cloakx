window.dji=window.dji||{};
(function(f){function l(a,c,b,m){c=(c||"").toLowerCase();var n=-1==c.indexOf("base64"),e={format:"jpeg"};switch(c){case d.PNG:case d.PNG_BASE64:e.format="png"}"number"==typeof b&&"jpeg"==e.format&&(e.quality=parserInt(b));chrome.tabs.captureVisibleTab(null,e,function(c){if(a){var b=new Image;b.onload=function(){var d=a.left,f=a.top,g=a.right-a.left,h=a.bottom-a.top;if(g!=b.width||h!=b.height){var l="png"===e.format?"image/png":"image/jpeg",k=document.createElement("canvas");k.width=g;k.height=h;k.getContext("2d").drawImage(b,
d,f,g,h,0,0,g,h);c=k.toDataURL(l)}p(c,n,m)};b.src=c}else p(c,n,m)})}function p(a,c,b){a&&c&&(a=dji.crypt.base64.decodeDataUrlStringToByteArray(a),a=new Uint8Array(a));b(a)}var d={JPEG:"jpeg",PNG:"png",JPEG_BASE64:"jpeg_base64",PNG_BASE64:"png_base64"};f.ImageFormats=d;f.takeScreenshot=function(a,c){a=a||{};a.fileSystem=a.fileSystem||dji.fileSystem.temporary;l(a.rect,a.imageFormat,a.imageQuality,function(b){var d=null!==b&&void 0!==b;d&&a.fileName?a.fileSystem.writeFile(a.fileName,b,function(b,d){dji.utils.callMethod(c,
b,a.fileName,d?d.toURL():"")}):dji.utils.callMethod(c,d,b)})}})(window.dji.screenshot=window.dji.screenshot||{});
