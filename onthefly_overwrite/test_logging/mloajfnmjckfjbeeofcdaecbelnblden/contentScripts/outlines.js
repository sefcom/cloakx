window.sru=window.sru||{};
(function(n){var y,p,u;function qb(){__$(".dji-sru-pagination-container").on("click",".dji-sru-page-content",T);__$(".dji-sru-pagination-container").on("dblclick",".dji-sru-folder-item",rb);__$(".dji-sru-pagination-container").on("click",".dji-sru-folder-item",sb);__$(".dji-sru-pagination-container").on("contextmenu",".dji-sru-folder-item",tb);__$(".dji-sru-pagination-container").on("click",".dji-sru-search-folder-item",ub);__$(".dji-sru-pagination-container").on("click",".dji-sru-folder-page .dji-sru-page-toolbar .dji-sru-folder-page-info .dji-sru-folder-name span",
ta);__$(".dji-sru-pagination-container").on("click",".dji-sru-folder-page .dji-sru-page-toolbar .dji-sru-folder-page-info .dji-sru-folder-full-path",ta);__$(".dji-sru-pagination-container").on("input",".dji-sru-folder-page input[dji-sru-search-outlines-input]",vb);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-page .dji-sru-page-toolbar .dji-sru-folder-page-info",ua);__$(".dji-sru-pagination-container").on("click",".dji-sru-back-to-parent-folder-page",va);__$(".dji-sru-pagination-container").on("click",
".dji-sru-tb-button.dji-sru-show-search-outlines",wb);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-hide-search-outlines",wa);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-reset-search-outlines",xa);__$(".dji-sru-pagination-container").on("click",".dji-sru-folder-page-new-folder",xb);__$(".dji-sru-pagination-container").on("click",".dji-sru-folder-page-menu",yb);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-page-menu",
zb);__$(".dji-sru-pagination-container").on("mousedown",".dji-sru-outline-new-topic",Ab);__$(".dji-sru-pagination-container").on("click",".dji-page-folder-new.dji-outline",Bb);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-hide-search-outline-template",ya);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-reset-search-outline-template",za);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-show-search-in-topics",Cb);__$(".dji-sru-pagination-container").on("input",
"input[dji-sru-search-in-topic-input]",Db);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-hide-search-in-topics",O);__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-highlight-prev-item",function(){sru.searchInOutlineController.highlightPrevSearchItem()});__$(".dji-sru-pagination-container").on("click",".dji-sru-tb-button.dji-sru-highlight-next-item",function(){sru.searchInOutlineController.highlightNextSearchItem()});__$(".dji-sru-pagination-container").on("click",
".dji-sru-tb-button.dji-sru-hide-search-in-topics",O);__$(".dji-sru-pagination-container").on("click",".dji-sru-back-button",va);__$(".dji-sru-pagination-container").on("input",".dji-sru-outline-page input[dji-sru-search-outline-template-input]",Eb);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-page .dji-sru-search-outline-template-overlay .dji-sru-search-result .dji-sru-search-outline-template",Fb);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-sources-page .dji-sru-outline-source .dji-sru-check-box",
Gb);__$("#dji-folder-page-template-dlg-1-cancel").on("click",function(){x(!1)});__$("#dji-sru-outline-move-to-dlg-cancel").on("click",function(){z({show:!1,updateUIPathState:!0})});__$("#dji-sru-outline-move-to-dlg .dji-sru-outline-new-folder").on("click",function(a){$(a.currentTarget).hasClass("dji-disable")?(a.stopPropagation(),a.preventDefault()):x(!0,{title:"New Folder",value:"New Folder",placeholder:"Folder Name",doneBtnText:"CREATE FOLDER",doneCallback:Hb})});__$("#dji-sru-outline-move-to-dlg .dji-sru-dialog-close").on("click",
function(){z({show:!1,updateUIPathState:!0})});__$("#dji-sru-outline-move-to-dlg .dji-sru-dialog-back").on("click",Ib);__$("#dji-sru-outline-move-to-dlg").on("dblclick",".dji-sru-folder-item",Jb);__$("#dji-sru-outline-move-to-dlg").on("click",".dji-sru-folder-item",Kb);__$("#dji-sru-outline-move-to-dlg-done").on("click",Lb);__$("#dji-sru-outline-source-dlg .dji-sru-dialog-close").on("click",function(){B({page:f(),show:!1,updateUIPathState:!0})});__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-tab-item-more[dji-item=dji-sru-outline-source-more]",
Mb);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-combobox-contributors",Nb);__$("#dji-sru-outline-source-dlg").on("blur",".dji-sru-combobox-contributors",Ob);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-combobox-contributors .dji-sru-contributor-option",Pb);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-form-button.dji-sru-source-add-author-button",Qb);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-tb-text-button.dji-sru-outline-source-save",Aa);__$("#dji-sru-outline-source-dlg").on("click",
".dji-sru-tb-button.dji-sru-hide-search-sources",Ba);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-tb-button.dji-sru-reset-search-sources",Ca);__$("#dji-sru-outline-source-dlg").on("keydown","input[dji-sru-search-sources-input]",Rb);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-search-result .dji-sru-search-source",Sb);__$("#dji-folder-page-delete-outline-dlg-save").on("click",Da);__$("#dji-folder-page-delete-outline-dlg-delete").on("click",Ea);__$(".dji-sru-pagination-container").on("click",
".dji-sru-tab-item",Tb);__$(".dji-sru-pagination-container").on("click",".dji-sru-oss-tab-item",Ub);__$("#dji-sru-outline-source-dlg").on("click",".dji-sru-tab-item",Vb);__$("#__dji_sru_main_container_content").on("click",".dji-sru-cite-button",Wb);__$(".dji-sru-pagination-container").on("focusout","#__dji_sru_searchSource",ca);__$(".dji-sru-pagination-container").on("keydown","#__dji_sru_searchSource",ca);__$(".dji-sru-pagination-container").on("input","#__dji_sru_searchSource",ca);__$(".dji-sru-pagination-container").on("click",
".dji-sru-cancel-citation-button",Fa);__$(".dji-sru-pagination-container").on("click",".dji-sru-material",Xb);__$(".dji-sru-pagination-container").on("click",".dji-sru-citation-searched-element",Yb);__$(".dji-sru-pagination-container").on("click",".dji-sru-manually-cite-button",Zb);__$(".dji-sru-pagination-container").on("click",".dji-sru-combobox-contributors",$b);__$(".dji-sru-pagination-container").on("click",".dji-sru-material-combobox",ac);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-source-bullet",
bc);__$("#dji-sru-sources-toolbar").on("click",cc);__$(".dji-sru-pagination-container").on("click",".dji-page-folder-new.dji-outline-new-source",dc);__$(".dji-sru-pagination-container").on("input",".dji-sru-edit-source-input",ec);__$(".dji-sru-pagination-container").on("click",".dji-sru-source-add-button",fc);__$(".dji-sru-pagination-container").on("click",".dji-sru-manually-cite-source-button",gc);__$(".dji-sru-pagination-container").on("click","#__dji_sru_cancel_select",Ga);__$(".dji-sru-pagination-container").on("click",
" .dji-sru-delete-button",hc);__$(".dji-sru-pagination-container").on("click"," .dji-sru-move-button",ic);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-details",Ha);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-sources",Ha);__$(".dji-sru-pagination-container").on("dragleave",".dji-sru-outline-topic",jc);__$(".dji-sru-pagination-container").on("mousedown",".dji-sru-outline-topic-bullet",kc);__$(".dji-sru-pagination-container").on("click",".dji-sru-outline-topic-content",
lc);__$(".dji-sru-pagination-container").on("keydown",".dji-sru-outline-topic-content",mc);__$(".dji-sru-pagination-container").on("paste",".dji-sru-outline-topic-content",nc);__$(".dji-sru-pagination-container").on("input",".dji-sru-outline-topic-content",oc);__$(".dji-sru-pagination-container").on("blur",".dji-sru-outline-topic-content",pc);__$(".dji-sru-pagination-container").on("click",".dji-sru-ellipses",Ia);__$(".dji-sru-pagination-container").on("click",".dji-sru-collapse",Ia);__$(".dji-sru-pagination-container").on("input",
".dji-sru-outline-search",qc);__$(".dji-sru-pagination-container").on("focusin",".dji-sru-outline-search",Ja);__$(".dji-sru-pagination-container").on("focusout",".dji-sru-outline-search",Ja);__$("#dji-sru-topics-toolbar").on("click",rc);__$(".dji-sru-pagination-container").on("click",'[dji-template-id="template-page-topic-element"] .dji-sru-intext-citation a',sc);__$("#dji-sru-sources-popup #__dji_sru_btnSourcesPopupCancel").on("click",Ka);__$("#dji-sru-sources-popup").on("click",".dji-sru-popup-source-element",
tc);dji.utils.addEventListenerToDocumentElements("drop",uc,!0);dji.utils.addEventListenerToBodyElements("mouseup",vc,!0);__$("body").on("contextmenu",wc);__$(".dji-sru-pagination-container").on("focus","input",La);__$(".dji-sru-pagination-container").on("focus","*[contenteditable]",La);__$("#dji-sru-folder-page-context-menu").on("click",function(){$(this).removeClass("dji-visible")});__$("#dji-sru-folder-page-item-context-menu").on("click",function(){$(this).removeClass("dji-visible")});__$("#dji-sru-outline-page-context-menu").on("click",
function(){$(this).removeClass("dji-visible")});__$("#dji-sru-outline-new-source-more-context-menu").on("click",function(){__$(".dji-sru-tab-item-more[dji-item=dji-sru-outline-source-more]").removeClass("dji-dropdown");$(this).removeClass("dji-visible")});__$("#dji-sru-folder-page-sort-by-alpha").on("click",U.alphabetical,Ma);__$("#dji-sru-folder-page-sort-by-time").on("click",U.recent,Ma);__$("#dji-sru-folder-page-move-to-outline-items").on("click",Na);__$("#dji-sru-folder-page-delete-outline-items").on("click",
Oa);__$("#dji-sru-outline-page-rename-outline").on("click",ua);__$("#dji-sru-folder-page-option-page").on("click",function(){dji.utils.callListeners(F,"options")});__$("#dji-sru-folder-page-sign-out").on("click",function(){dji.utils.callListeners(F,"signOut")});__$("#dji-sru-outline-page-download").on("click",function(){sru.downloadController.download(f().outline,"APA")});__$("#dji-sru-outline-page-print").on("click",function(){sru.printController.print(f().outline,"APA")});__$("#dji-sru-search-sources").on("click",
xc);__$("#dji-sru-folder-page-item-rename-outline").on("click",yc);__$("#dji-sru-folder-page-item-move-to-outline").on("click",Na);__$("#dji-sru-folder-page-item-delete-outline").on("click",Oa);__$("#dji-sru-outline-new-source-more-context-menu").on("click",".dji-sru-menu-item[dji-item]",zc);__$("#dji-sru-search-outline-template").on("click",Ac)}function La(a){sru.mainContainer.focus(function(b){b&&a.target.focus()})}function Pa(){p=null;u=!1;x(!1);V(!1);z({show:!1,updateUIPathState:!1});B({page:f(),
show:!1,updateUIPathState:!1});var a=sru.outlinesDataManager.uiPathSize();dji.ui.pagination.createPages(t,a,null,function(a,c,d){sru.toolbar.enableHighlightButton(!1);d=sru.outlinesDataManager.uiPathState(c);var e=sru.outlinesDataManager.outlineFromUiPathState(d),h=sru.outlinesDataManager.topicFromUiPathState(d),f=sru.outlinesDataManager.sourceFromUiPathState(d);d.outlineViewMode&&(W=d.outlineViewMode);0==c?(P(a,e,d.selectedOutlines),"moveTo"==d.view&&(c=null,d.moveToOutline&&(c="home"==d.moveToOutline?
sru.outlinesDataManager.home():sru.outlinesDataManager.outlineByUuid(d.moveToOutline)),z({show:!0,outline:c,selOutline:d.moveToSelOutline,updateUIPathState:!1}),sru.toolbar.enableHighlightButton(!1))):("outline"==d.pageType&&(P(a,e,d.selectedOutlines,d.selTab,d.sourceType),"moveTo"==d.view?(c=null,d.moveToOutline&&(c="home"==d.moveToOutline?sru.outlinesDataManager.home():sru.outlinesDataManager.outlineByUuid(d.moveToOutline)),z({show:!0,outline:c,selOutline:d.moveToSelOutline,updateUIPathState:!1}),
sru.toolbar.enableHighlightButton(!1)):"source"==d.view&&(B({page:a,show:!0,dlgMode:d.dlgMode,selTabItem:d.sourceTabItem,source:f,updateUIPathState:!1}),sru.toolbar.enableHighlightButton(!1))),"linkToSource"==d.pageType&&(a.outline=e,a.topic=h,Qa(a,e,h),"source"==d.view&&B({page:a,show:!0,dlgMode:d.dlgMode,selTabItem:d.sourceTabItem,source:f,updateUIPathState:!1})))})}function f(){return t.querySelector(".dji-sru-page-current")}function Bb(){dji.ui.pagination.nextPage(t,function(a){var b=sru.outlinesDataManager.createSkeletonOutline(f().outline);
P(a,b)},function(){$(f()).find(".dji-sru-page-content ul#u000 li.dji-sru-outline-topic .dji-sru-outline-topic-content").focus()})}function Bc(){var a=f().topic;$(f()).find(".dji-sru-page-content.dji-sru-outline-sources").children().each(function(){var b=this.__state;if(b.currentLinked!=b.originalLinked){var c=this.source;b.currentLinked?a.linkSource(c):a.unlinkSource(c)}})}function va(a){sru.toolbar.enableHighlightButton(!1);f().outline.isSkeleton()?(Q&&sru.toolbar.disableHighlight(),V(!0,f().outline)):
($(a.currentTarget).hasClass("dji-sru-link-to-source")&&Bc(),dji.ui.pagination.previousPage(t,function(a){var c=a.outline;c.isHome()||c.isDirectory()?w(a):(da(a),ea(a),c=$(a).find(".dji-sru-tab-items .dji-sru-tab-item.dji-selected").attr("dji-item"),sru.toolbar.enableHighlightButton("dji-sru-outline-details"==c));Q&&sru.toolbar.disableHighlight();sru.outlinesDataManager.popOutlineFromStack();sru.toolbar.setTitle(a.outline)}))}function rb(a){__$(f()).find(".dji-sru-page-content").hasClass("dji-sru-outline-select")||
dji.ui.pagination.nextPage(t,function(b){var c=a.currentTarget.outline;sru.outlinesDataManager.pushOutlineToStack(c);P(b,c)})}function sb(a){if(a.ctrlKey||a.metaKey)y=$(a.currentTarget).hasClass("dji-selected")?a.currentTarget:null,$(a.currentTarget).toggleClass("dji-selected");else if(a.shiftKey)if($(a.currentTarget).parent().find(".dji-sru-folder-item").removeClass("dji-selected"),$(a.currentTarget).addClass("dji-selected"),null==y)y=a.currentTarget;else{if(y==a.currentTarget)return;var b=$(y).index(),
c=$(a.currentTarget).index();if(b>c)var d=b,b=c,c=d+1;$(y).parent().children().slice(b,c).addClass("dji-selected");a.preventDefault();a.stopPropagation()}else $(a.currentTarget).hasClass("dji-selected")?($(a.currentTarget).parent().find(".dji-sru-folder-item").removeClass("dji-selected"),y=null):($(a.currentTarget).parent().find(".dji-sru-folder-item").removeClass("dji-selected"),$(a.currentTarget).addClass("dji-selected"),y=a.currentTarget);a=sru.outlinesDataManager.currentUiPathState();a.selectedOutlines=
Cc();sru.outlinesDataManager.updateUiPathState(a)}function tb(a){if(!__$(f()).find(".dji-sru-page-content").hasClass("dji-sru-outline-select")){$(a.currentTarget).parent().find(".dji-sru-folder-item").removeClass("dji-selected");$(a.currentTarget).addClass("dji-selected");var b=a.clientX,c=a.clientY,d=a.currentTarget.outline,e=__$("#dji-sru-folder-page-item-context-menu");G=d;d=e.find(".dji-sru-context-menu")[0];b+$(d).width()>=e.width()-10&&(b=e.width()-10-$(d).width());c+200>=$(window).height()&&
(c=$(window).height()-200);d.style.left=b+"px";d.style.top=c+"px";e.addClass("dji-visible");a.preventDefault();a.stopPropagation()}}function ub(a){wa();dji.ui.pagination.nextPage(t,function(b){var c=a.currentTarget.outline;sru.outlinesDataManager.pushOutlineToStack(c);P(b,c)})}function fa(a){if(!a||a.isHome())return"<div class='dji-sru-folder-name'>Home</div>";var b;b=30-Math.min(a.title().length,10);for(var c="",d=[],e=a.parent();!e.isHome();)d.push(e.title()),c=e.title()+" > "+c,e=e.parent();d.push("Home");
c="Home > "+c;if(c.length>b)if(d.reverse(),e=d[d.length-1].length,d[0].length+e>b-6)c=d[0]+" > ... > ";else{for(var h=0,c="";e+d[h].length+5<b&&h<d.length-1;)c+=d[h]+" > ",e+=d[h].length+3,h++;c+=" ... > "+d[d.length-1]+" > "}return"<div class='dji-sru-folder-full-path'>"+(c+"&nbsp;")+"</div><div class='dji-sru-folder-name'><span>"+a.title()+"</span></div>"}function P(a,b,c,d,e){a.outline=b;if(b.isHome()||b.isDirectory())sru.toolbar.enableHighlightButton(!1),a.appendChild(dji.ui.templates.load(l,
"dji-template-folder-page")),c=c||[],w(a,c),d=fa(b),I(a,d,!0);else{a.appendChild(dji.ui.templates.load(l,"dji-template-sru-outline-page"));J=null;a.querySelector(".dji-sru-page-content").querySelector(".dji-sru-outline-content").addEventListener("scroll",T);p=null;u=!1;c=a.outline.topics();if(0<c.length)for(var h=a.querySelector("#u000"),f=0;f<c.length;f++)ga(a,c[f],h);else H(a);e=e||"APA";if(h=a.outline)if($(a).find(".dji-sru-tab-items.dji-outline-sources-style .dji-sru-oss-tab-item.dji-selected").removeClass("dji-selected"),
$(a).find(".dji-sru-tab-items.dji-outline-sources-style .dji-sru-oss-tab-item[dji-oss-style="+e+"]").addClass("dji-selected"),c=$(a).find("#dji-workaround-s000"),h=h.sources(),e=e||"APA",0==h.length)$(a).find(".dji-sru-page-content .dji-tab-item-view.dji-sru-outline-content.dji-sru-outline-sources").addClass("dji-empty");else for($(a).find(".dji-sru-page-content .dji-tab-item-view.dji-sru-outline-content.dji-sru-outline-sources").removeClass("dji-empty"),f=0;f<h.length;f++)Ra(c,h[f],e);e=b.isSkeleton()?
"Outline Name":b.title();I(a,e);d=d||"dji-sru-outline-details";sru.toolbar.enableHighlightButton("dji-sru-outline-details"==d);A(a,d)}sru.toolbar.setTitle(b);b.isHome()?__$(a).find(".dji-sru-page-toolbar").removeAttr("dji-back-button"):__$(a).find(".dji-sru-page-toolbar").attr("dji-back-button","")}function w(a,b){var c=a.querySelector(".dji-sru-page-content");Sa(c);var d=a.outline,e=d.outlines();if(d.isHome()&&0==e.length)$(a).find(".dji-sru-page-content").addClass("dji-sru-no-outline");else{$(a).find(".dji-sru-page-content").removeClass("dji-sru-no-outline");
var f,g;b=b||[];if(W==U.recent){if(e.sort(function(a,b){return a.modifiedDate()<b.modifiedDate()?1:a.modifiedDate()>b.modifiedDate()?-1:0}),0!=e.length){var k=!1,q=Date.now(),l=!1;for(f=0;f<e.length;f++)d=e[f],g=-1!=b.indexOf(d.uuid()),l||(2592E6>=q-d.modifiedDate()?k||(k=!0,X(c,"Recent")):(l=!0,X(c,"Oldest",k))),K(c,d,g)}}else{e.sort(function(a,b){return a.title().toLowerCase()>b.title().toLowerCase()?1:a.title().toLowerCase()<b.title().toLowerCase()?-1:0});k=[];q=[];for(f=0;f<e.length;f++)d=e[f],
d.isDirectory()?k.push(d):q.push(d);if(0!=k.length)for(X(c,"Folders"),f=0;f<k.length;f++)d=k[f],g=-1!=b.indexOf(d.uuid()),K(c,d,g);if(0!=q.length)for(X(c,"Outlines",0!=k.length),f=0;f<q.length;f++)d=q[f],g=-1!=b.indexOf(d.uuid()),K(c,d,g)}}}function Sa(a){for(;a.firstChild;)a.removeChild(a.firstChild)}function X(a,b,c){var d=dji.ui.templates.load(l,"dji-sru-folder-item-group-label");c&&(d.className+=" dji-top-border");d.innerText=b;a.appendChild(d)}function K(a,b,c){var d=b.isHome()?"dji-sru-folder-item-home":
b.isDirectory()?"dji-sru-folder-item-subfolder":"dji-sru-folder-item-outline",d=dji.ui.templates.load(l,d);d.outline=b;d.id=b.uuid();if(!b.isHome()){var e=new Date(b.modifiedDate()),f=e.getMonthName("en"),g=e.getDate(),e=e.getFullYear(),f=f+" "+g+", "+e;d.querySelector(".dji-sru-folder-item-name").innerText=b.title();d.querySelector(".dji-sru-folder-item-date").innerText=f}c&&$(d).addClass("dji-selected");a.appendChild(d)}function Ta(a,b){var c;switch(b){case "dji-sru-outline-source-book":c="template-page-book-citation-form";
break;case "dji-sru-outline-source-webpage":c="template-page-webpage-citation-form";break;case "dji-sru-outline-source-journal":c="template-page-journal-citation-form";break;case "dji-sru-outline-source-magazine":c="template-page-magazine-citation-form";break;case "dji-sru-outline-source-newspaper":c="template-page-newspaper-citation-form";break;case "dji-sru-outline-source-tv-radio":c="template-page-television-citation-form";break;case "dji-sru-outline-source-visual-art":c="template-page-visual-citation-form";
break;default:return}var d=dji.ui.templates.load(l,"dji-sru-template-page-source-author-line");a.append(d);d=dji.ui.templates.load(l,c);a.append(d)}function L(a,b){var c=b.find(".dji-sru-tab-item.dji-selected");c.removeClass("dji-selected");$(a).find(".dji-tab-item-view["+c.attr("dji-item")+"]").removeClass("dji-visible")}function A(a,b,c){$(a).find(".dji-sru-tab-item[dji-item="+b+"]").addClass("dji-selected");switch(b){case "dji-sru-outline-details":sru.toolbar.enableHighlightButton(!0);$(a).find(".dji-sru-page-toolbar .dji-sru-tb-button.dji-sru-outline-new-topic").removeClass("dji-hidden");
a.topic=null;break;case "dji-sru-outline-sources":sru.toolbar.enableHighlightButton(!1),$(a).find(".dji-sru-page-toolbar .dji-sru-tb-button.dji-sru-outline-new-topic").addClass("dji-hidden")}a=$(a).find(".dji-tab-item-view["+b+"]");c&&a.is(":empty")&&Ta(a,b);a.addClass("dji-visible")}function I(a,b,c){c?__$(a).find(".dji-sru-page-toolbar .dji-sru-folder-page-info").html(b):__$(a).find(".dji-sru-page-toolbar .dji-sru-folder-page-info").text(b)}function Qa(a,b,c){var d=dji.ui.templates.load(l,"dji-template-outline-link-to-source");
a.appendChild(d);a=$(d).find(".dji-sru-page-content");Ua(a,c,b,"APA")}function da(a){J=null;a.querySelector(".dji-sru-page-content").querySelector(".dji-sru-outline-content");var b=a.querySelector("#u000");$(b).empty();p=null;u=!1;var c=a.outline.topics();if(0<c.length)for(var d=0;d<c.length;d++)ga(a,c[d],b);else H(a)}function ea(a){var b=a.outline;if(b){var c=$(a).find("#dji-workaround-s000");c.empty();var b=b.sources(),d=$(a).find(".dji-sru-page-content .dji-tab-item-view.dji-sru-outline-sources .dji-sru-oss-tab-item.dji-selected").attr("dji-oss-style"),
d=d||"APA";if(0==b.length)$(a).find(".dji-sru-page-content .dji-tab-item-view.dji-sru-outline-content.dji-sru-outline-sources").addClass("dji-empty");else for($(a).find(".dji-sru-page-content .dji-tab-item-view.dji-sru-outline-content.dji-sru-outline-sources").removeClass("dji-empty"),a=0;a<b.length;a++)Ra(c,b[a],d)}}function ga(a,b,c){c=Va(a,b,c);b=a.outline.topics(b);if(0<b.length){c=c.querySelector("ul");c.style.display="block";for(var d=0;d<b.length;d++)ga(a,b[d],c)}}function Va(a,b,c,d){var e=
dji.ui.templates.load(l,"template-page-topic-element");b?(e.id=b.uuid(),e.topic=b):e.id="0";e.setAttribute("draggable","true");e.addEventListener("dragstart",ha);e.addEventListener("dragover",Dc);e.addEventListener("drop",Ec);e.querySelector(".dji-sru-outline-topic-content").innerHTML=b?b.body():"";a=c||a.querySelector("#u000");d?a.insertBefore(e,d.nextSibling):a.appendChild(e);b&&Wa(b,e);return e}function H(a,b){p&&""===p.querySelector(".dji-sru-outline-topic-content").innerText&&Y(f(),p);var c=
Va(a,null,b?b.parentNode:null,b),d=c.querySelector(".dji-sru-outline-topic-content");p=c;u=!1;var c=d.getBoundingClientRect(),e=__$(d).closest(".dji-sru-outline-content.dji-sru-outline-details")[0],h=e.getBoundingClientRect();c.bottom+60>h.bottom&&(e.scrollTop+=h.bottom-c.bottom+60);__$.querySelector("html").hasAttribute("dji-sru-outline-active")&&(d.setAttribute("contenteditable",!0),setTimeout(function(){d.focus()},0))}function Wa(a,b){var c,d;b=b||__$.getElementById(a.uuid());if(!a.hasLinkedSources()&&
b.querySelector(".dji-sru-intext-citation"))b.querySelector(".dji-sru-intext-citation").innerHTML="";else{for(var e="",f=a.sources(),e=[],g,k,q=0;q<f.length;q++)k=f[q].cslData(),d=c=void 0,g=null,k?(c=k.author&&0<k.author.length&&""!=k.author[0].family?k.author[0].family:k["container-title"],k.issued&&k.issued.year&&(g=k.issued.year),c=c&&g?c+" "+g:c?c:"...",k.URL&&(d=k.URL)):k||(c=f[q].author().split(",")[0]),d=d?"(<a id='"+f[q].uuid()+"' href="+d+">"+c+"</a>)":"(<span>"+c+"</span>)",e.push(d);f=
e[0];q="";for(d=1;d<e.length;d++)f=f+", "+e[d],1==d&&(q=f+"<span class = 'dji-sru-ellipses'> &nbsp ...</span>");e=3<=e.length?q:f;b.querySelector(".dji-sru-intext-citation").innerHTML=e;b.fullIntextCitations=f;b.partialIntextCitations=q}}function T(a){f().querySelector("[dji-template-id=template-page-outline-topics]")?n.hideBulletToolbars():f().querySelector(".dji-sru-manually-cite-view")&&(a=f().querySelector(".dji-sru-material-selection"),__$(a).hasClass("dji-visible")&&__$(a).removeClass("dji-visible"),
a=f().querySelector(".dji-sru-contributors-selection"),__$(a).hasClass("dji-visible")&&__$(a).removeClass("dji-visible"))}function Xa(){var a=f();Fc(a);__$(a).find(".dji-sru-page-content").removeClass("dji-sru-outline-select");a=sru.outlinesDataManager.currentUiPathState();a.selection=!1;sru.outlinesDataManager.updateUiPathState(a)}function Ga(){Xa();var a=f();0==__$(a).find(".dji-sru-outline-content").children().length&&a.outline.isHome()&&(a.querySelector(".dji-sru-no-outlines-img").style.display=
"block")}function hc(){var a=Ya(f()).selected;if(0!=a.length){f().outline.deleteOutlines(a);for(var b=0;b<a.length;b++)__$(f()).find("#"+a[b].uuid()).remove();Ga()}}function ic(){var a=sru.outlinesDataManager.currentUiPathState();a.view="moveDialog";sru.outlinesDataManager.updateUiPathState(a);Gc(f())}function Gc(a){sru.mainContainer.enterBusyState();__$("html").addClass("dji-sru-move-folder-dialog");setTimeout(function(){Hc.focus()},0);var b=sru.outlinesDataManager.directories();b&&(a=Ya(a).selected,
sru.outlinesMoveDialog.show(a,b))}function Ya(a){var b={selected:[],selectedIds:[]};__$(a).find('.dji-sru-outline-check[dji-checked = "true"]').each(function(){b.selected.push(__$(this).parent()[0].outline);b.selectedIds.push(__$(this).parent()[0].outline.uuid())});return b}function Fc(a){__$(a).find('.dji-sru-outline-check[dji-checked = "true"]').each(function(){__$(this).attr("dji-checked","false")})}function Tb(a){var b=$(a.target);if(!b.hasClass("dji-selected")){a=b.attr("dji-item");var c=f();
L(c,b.parent());b=c.outline;!b||b.isHome()||b.isDirectory()?A(c,a):(A(c,a),c=sru.outlinesDataManager.currentUiPathState(),c.selTab=a,sru.outlinesDataManager.updateUiPathState(c),sru.searchInOutlineController.updatePageHighlight())}}function Ic(a,b){dji.ui.pagination.nextPage(t,function(c){c.outline=a;c.topic=b;Qa(c,a,b)})}function Ka(){if(!__$(R).is(":hidden")){for(var a=f().topic,b=!1,c=R.querySelectorAll("div.dji-sru-popup-source-element"),d=0;d<c.length;d++){var e=c[d],h=e.__state;h.currentLinked!=
h.originalLinked&&(b=!0,e=e.source,h.currentLinked?a.linkSource(e):a.unlinkSource(e))}b&&f();__$("html").removeClass("dji-sru-sources-popup");f().topic=null;sru.mainContainer.leaveBusyState();a=sru.outlinesDataManager.currentUiPathState();a.view="outline";a.uuidTopic=null;sru.outlinesDataManager.updateUiPathState(a)}}function Gb(a){var b=$(a.currentTarget.parentNode);a=a.currentTarget.parentNode.__state;a.currentLinked=!a.currentLinked;b.hasClass("dji-selected")?(b.removeClass("dji-selected"),b.find(".dji-sru-check-box i").text("check_box_outline_blank")):
(b.addClass("dji-selected"),b.find(".dji-sru-check-box i").text("check_box"))}function tc(a){var b=a.currentTarget.__state;b.currentLinked=!b.currentLinked;b.currentLinked?$(a.currentTarget).addClass("dji-sru-current-topic"):$(a.currentTarget).removeClass("dji-sru-current-topic")}function Ua(a,b,c,d){a.empty();if(c){c=c.sources();0==c.length?a.addClass("dji-empty"):a.removeClass("dji-empty");d=d||"APA";for(var e=0;e<c.length;e++){var f=a,g=b,k=c[e],q=d,C=void 0,n=void 0,m=!1,C=dji.ui.templates.load(l,
"dji-sru-template-outline-checked-source");g.hasLinkedSource(k)&&(m=!0,$(C).addClass("dji-selected"),$(C).find(".dji-sru-check-box i").text("check_box"));n=__$(C).find(".dji-sru-outline-source-content");n.html(k.text(q)||"generate citation from source.data.fields with style "+q);C.topics=g;C.source=k;C.__state={originalLinked:m,currentLinked:m};f.append(C)}}}function Ra(a,b,c,d){var e;e=dji.ui.templates.load(l,"dji-sru-template-outline-source");e.setAttribute("draggable","true");e.addEventListener("dragstart",
ha);__$(e).find(".dji-sru-outline-source-content").html(b.text(c)||"generate citation from source.data.fields with style "+c);e.topics=d;e.source=b;a.append(e)}function Za(a,b,c,d,e){__$(a).empty();if(c){c=c.sources();var f=__$.querySelector("div.dji-style-selected");e=e||(f?f.innerText:"APA");for(f=0;f<c.length;f++){var g=a,k=c[f],q=e,n=b,m=void 0,p=void 0;d?(p=n.hasLinkedSource(k),m=dji.ui.templates.load(l,"dji-sru-template-page-popup-source-element"),m.__state={originalLinked:p,currentLinked:p},
p&&__$(m).addClass("dji-sru-current-topic"),p=m.querySelector(".dji-sru-popup-source-element-content")):(m=dji.ui.templates.load(l,"template-page-citation-element"),p=m.querySelector(".dji-sru-outline-source-content"),m.setAttribute("draggable","true"),m.addEventListener("dragstart",ha));q=k.text(q)||"generate citation from source.data.fields with style"+q;p.innerHTML=q;m.source=k;g.appendChild(m)}}}function Xb(a){a.stopPropagation();a=a.currentTarget;if(!__$(a).hasClass("dji-sru-material-selected")){var b=
__$(a.parentNode).find(".dji-sru-material-selected");__$(a).hasClass("dji-sru-material-combobox")||b.removeClass("dji-sru-material-selected");b=f().querySelector(".dji-sru-material-selection");__$(b).hasClass("dji-visible")&&__$(b).removeClass("dji-visible");__$(a).addClass("dji-sru-material-selected");"-webkit-flex"!=f().querySelector(".dji-sru-page-content").querySelector(".dji-sru-new-source-view").style.display&&((a=__$(a).attr("dji-material"))&&$a(f(),a),b=sru.outlinesDataManager.currentUiPathState(),
b.formType=a,sru.outlinesDataManager.updateUiPathState(b))}}function Ub(a){a=$(a.target);if(!a.hasClass("dji-selected")){a.parent().find(".dji-sru-oss-tab-item.dji-selected").removeClass("dji-selected");a.addClass("dji-selected");var b=a.attr("dji-oss-style");$(f()).find(".dji-sru-page-content #dji-workaround-s000 li.dji-sru-outline-source").each(function(){var a=this.source;$(this).find(".dji-sru-outline-source-content").html(a.text(b))});sru.searchInOutlineController.updatePageHighlight();a=sru.outlinesDataManager.currentUiPathState();
a.sourceType=b;sru.outlinesDataManager.updateUiPathState(a)}}function ac(a){var b=a.target;a=a.currentTarget.querySelector(".dji-sru-material-selection");__$(a).hasClass("dji-visible")?__$(a).removeClass("dji-visible"):__$(a).addClass("dji-visible");if(a=__$(b).attr("dji-material-sel")){var c=b.closest(".dji-sru-material-container").querySelector(".dji-sru-material-selected");__$(c).removeClass("dji-sru-material-selected");b=b.closest(".dji-sru-material-container").querySelector(".dji-sru-special");
b.innerText=M[a].tabName;b.setAttribute("dji-material",a);__$(b).addClass("dji-sru-material-selected");$a(f(),a);b=sru.outlinesDataManager.currentUiPathState();b.formType=a;sru.outlinesDataManager.updateUiPathState(b)}}function Yb(a){var b=a.currentTarget.source;dji.ui.pagination.previousPage(t,function(a){sru.outlinesDataManager.activeOutline().createSource(b,!1,a.topic);$(a).find(".dji-sru-page-content").hasClass("dji-sru-sources")&&Za(a.querySelector("#dji_workaround-s000"),null,f().outline);a.topic&&
(a.topic=null);sru.outlinesDataManager.popUiPathState()})}function Wb(a){$(a.target).hasClass("dji-sru-sources-popup")&&(sru.mainContainer.leaveBusyState(),__$("html").removeClass("dji-sru-sources-popup"),a=sru.outlinesDataManager.currentUiPathState(),a.view="outline",a.uuidTopic=null,sru.outlinesDataManager.updateUiPathState(a));dji.ui.pagination.nextPage(t,function(a){var c=f().outline,d=f().topic;a.appendChild(dji.ui.templates.load(l,"template-page-new-source"));a.outline=c;a.topic=d;c={uuid:a.outline.uuid(),
pageType:"citation",view:"searchCite"};f().topic&&(a.topic=f().topic,c.uuidTopic=a.topic.uuid());sru.outlinesDataManager.pushUiPathState(c)})}function Zb(a){}function $a(a,b,c,d){var e=a.querySelector(".dji-sru-forms-container");__$(e).empty();if(c||d)__$(a).find(".dji-sru-material-selected").removeClass("dji-sru-material-selected"),d=__$(a).find("[dji-material='"+b+"']"),d&&0!=d.length||(d=__$(a).find(".dji-sru-special"),d.attr("dji-material",b),d.text(M[b].tabName)),d.addClass("dji-sru-material-selected");
switch(b){case v.Book:d=dji.ui.templates.load(l,"template-page-book-citation-form");break;case v.Journal:d=dji.ui.templates.load(l,"template-page-journal-citation-form");break;case v.Webpage:d=dji.ui.templates.load(l,"template-page-webpage-citation-form");break;case v.Movie:d=dji.ui.templates.load(l,"template-page-video-citation-form");break;case v.Television:d=dji.ui.templates.load(l,"template-page-television-citation-form");break;case v.Magazine:d=dji.ui.templates.load(l,"template-page-magazine-citation-form");
break;case v.Newspaper:d=dji.ui.templates.load(l,"template-page-newspaper-citation-form");break;case v.Visual:d=dji.ui.templates.load(l,"template-page-visual-citation-form");break;default:d=dji.ui.templates.load(l,"template-page-video-citation-form")}e.appendChild(d);if(c=c||(a.source?a.source.cslData():null)){a=a.querySelector(".dji-sru-forms-container");c.id="id0";e=a.childNodes[0];ia(e,c.author,r.Author,b);ia(e,c.editor,r.Editor,b);ia(e,c.translator,r.Translator,b);c.author&&0!=c.author.length||
c.editor&&0!=c.editor.length||c.translator&&0!=c.translator.length||ja(e,b,null);c.title&&(b=a.querySelector(".dji-sru-edit-source-title-container>.dji-sru-edit-source-input"))&&(b.value=c.title);c["container-title"]&&(b=a.querySelector(".dji-sru-edit-content-title-container>.dji-sru-edit-source-input"))&&(b.value=c["container-title"]);c.publisher&&(b=a.querySelector(".dji-sru-edit-publisher-container>.dji-sru-edit-source-input"))&&(b.value=c.publisher);c.volume&&(b=a.querySelector(".dji-sru-edit-vol-container>.dji-sru-edit-source-input"))&&
(b.value=c.volume);c.issue&&(b=a.querySelector(".dji-sru-edit-issue-container>.dji-sru-edit-source-input"))&&(b.value=c.issue);c.edition&&(b=a.querySelector(".dji-sru-edit-edition-container>.dji-sru-edit-source-input"))&&(b.value=c.edition);c.issued&&(c.issued.year&&(b=a.querySelector(".dji-sru-edit-year-container>.dji-sru-edit-source-input"))&&(b.value=c.issued.year),c.issued.month&&(b=a.querySelector(".dji-sru-edit-month-container>.dji-sru-edit-source-input"))&&(b.value=c.issued.month),c.issued.day&&
(b=a.querySelector(".dji-sru-edit-day-container>.dji-sru-edit-source-input"))&&(b.value=c.issued.day),c.issued.season&&(b=a.querySelector(".dji-sru-edit-season-container>.dji-sru-edit-source-input"))&&(b.value=c.season));c.accessed&&(b=a.querySelector(".dji-sru-last-accessed span"))&&(b.innerText=c.accessed.day+"-"+c.accessed.month+"-"+c.accessed.year);c["number-of-pages"]&&(b=a.querySelector(".dji-sru-edit-no-pages-container>.dji-sru-edit-source-input"))&&(b.value=c["number-of-pages"]);c.page&&(b=
a.querySelector(".dji-sru-edit-pages-container>.dji-sru-edit-source-input"))&&(b.value=c.page);c.ISSN&&(b=a.querySelector(".dji-sru-edit-ISSN-container>.dji-sru-edit-source-input"))&&(b.value=c.ISSN);c.ISBN&&(b=a.querySelector(".dji-sru-edit-ISBN-container>.dji-sru-edit-source-input"))&&(b.value=c.ISBN);c.DOI&&(b=a.querySelector(".dji-sru-edit-DOI-container>.dji-sru-edit-source-input"))&&(b.value=c.DOI);c.URL&&(b=a.querySelector(".dji-sru-edit-URL-container>.dji-sru-edit-source-input"))&&(b.value=
c.URL);if(c["publisher-place"]){b=c["publisher-place"].split(",");if(e=a.querySelector(".dji-sru-edit-city-container>.dji-sru-edit-source-input"))e.value=b[0];1<b.length&&(e=a.querySelector(".dji-sru-edit-country-container>.dji-sru-edit-source-input"))&&(e.value=b[1])}(b=a.querySelector(".dji-sru-edit-medium-container>.dji-sru-edit-source-input"))&&c.medium&&(b.value=c.medium);c=a.querySelectorAll(".dji-sru-source-placeholder");for(a=0;a<c.length;a++)""!==__$(c[a]).next().val()&&__$(c[a]).addClass("dji-sru-source-placeholder-visible")}else ja(d,
b)}function ja(a,b,c){b=b==v.Movie?dji.ui.templates.load(l,"template-page-source-moviecontributors-line"):b==v.Television?dji.ui.templates.load(l,"template-page-source-tvcontributors-line"):b==v.Visual?dji.ui.templates.load(l,"template-page-source-visualcontributors-line"):dji.ui.templates.load(l,"template-page-source-author-line");c?__$(b).insertAfter(__$(c)):a.insertBefore(b,a.childNodes[0]);return b}function ia(a,b,c,d){if(b&&0!=b.length)for(var e=0;e<b.length;e++){var f=a.querySelectorAll(".dji-sru-combobox-contributors"),
f=ja(a,d,f&&0<f.length?f[f.length-1].parentNode:null);"template-page-source-author-line"==f.getAttribute("dji-template-id")&&(f.querySelector(".dji-sru-combobox-label").innerText=c);var g=f.querySelector(".dji-sru-edit-fname-container>.dji-sru-edit-source-input");b[e].given&&(g.value=b[e].given);f=f.querySelector(".dji-sru-edit-lname-container>.dji-sru-edit-source-input");b[e].family&&(f.value=b[e].family)}}function ec(a){a=a.target;var b=a.parentNode.querySelector(".dji-sru-source-placeholder");
""!=a.value||$(a).hasClass("dji-date-details")?__$(b).addClass("dji-sru-source-placeholder-visible"):__$(b).removeClass("dji-sru-source-placeholder-visible")}function $b(a){a.stopPropagation();var b=a.currentTarget.querySelector(".dji-sru-contributors-selection");__$(b).hasClass("dji-visible")?__$(b).removeClass("dji-visible"):__$(b).addClass("dji-visible");__$(a.target).hasClass("dji-sru-select-author")?a.currentTarget.querySelector(".dji-sru-combobox-label").innerText="Author":__$(a.target).hasClass("dji-sru-select-editor")?
a.currentTarget.querySelector(".dji-sru-combobox-label").innerText="Editor":__$(a.target).hasClass("dji-sru-select-translator")&&(a.currentTarget.querySelector(".dji-sru-combobox-label").innerText="Translator")}function fc(a){var b=a.target.parentNode;a.target.style.display="none";a=$(b).attr("dji-template-id");a=dji.ui.templates.load(l,a);__$(a).insertAfter(__$(b))}function Jc(){var a=!0,b=f().source?f().source.cslData(!0):{};b.id="id0";var c=__$("#dji-sru-outline-source-dlg").find(".dji-sru-tab-items .dji-sru-tab-item.dji-selected").attr("dji-item");
b.type=M[c].cslType;var c=__$("#dji-sru-outline-source-dlg").find(".dji-tab-item-view.dji-source-view.dji-visible"),d=[],e=[],h=[];c.find(".dji-sru-form-line.dji-sru-page-source-author-line").each(function(){var a=$(this).find(".dji-sru-edit-fname-container input").val(),b=$(this).find(".dji-sru-edit-lname-container input").val(),c=$(this).find(".dji-sru-combobox-label").text();if(""!=a||""!=b)switch(a={family:b,given:a},c){case r.Author:case r.Director:case r.Artist:case r.Writer:d.push(a);break;
case r.Editor:e.push(a);break;case r.Translator:h.push(a)}});b.author=d;b.editor=e;b.translator=h;var a=0==b.author.length&&0==b.editor.length&&0==b.translator.length,g;g=c.find("input[dji-csl-item]");g.each(function(){var c=$(this).val();if(c&&""!==c){var d=$(this).attr("dji-csl-item");b[d]=c;a=!1}});g=c.find("input[dji-csl-add-to-item]");g.each(function(){var c=$(this).val();if(c&&""!==c){var d=$(this).attr("dji-csl-add-to-item");b[d]=(b[d]?b[d]+", ":"")+c;a=!1}});b.issued={};var k=[];g=c.find("input[dji-csl-item-year]");
(g=g.val())&&""!==g&&k.push(g);g=c.find("input[dji-csl-item-month]");(g=g.val())&&""!==g&&k.push(g);g=c.find("input[dji-csl-item-day]");(g=g.val())&&""!==g&&k.push(g);0<k.length&&(b.issued["date-parts"]=[k],a=!1);return a?null:b}function Aa(){var a=f(),b=Jc();if(null!=b){a.source?f().source.update(b,!0):sru.outlinesDataManager.activeOutline().createSource(b,!1,f().topic);if("new-link-source"==__$("#dji-sru-outline-source-dlg").attr("dji-sru-mode")){var b=a.outline,c=a.topic,a=$(a).find(".dji-sru-page-content");
Ua(a,c,b,"APA")}else ea(a);B({page:f(),show:!1,updateUIPathState:!0})}}function gc(){var a=f().querySelector(".dji-sru-page-content .dji-sru-forms-container"),b=f().querySelector(".dji-sru-manually-cite-view .dji-sru-material-selected"),c=f().source?f().source.cslData(!0):{};c.id="id0";for(var d=a.querySelectorAll(".dji-sru-combobox-contributors"),e=[],h=[],g=[],k=0;k<d.length;k++){var l=d[k].parentNode.querySelector(".dji-sru-edit-fname-container>.dji-sru-edit-source-input").value,m=d[k].parentNode.querySelector(".dji-sru-edit-lname-container>.dji-sru-edit-source-input").value,
n=d[k].querySelector(".dji-sru-combobox-label");if(""!=l||""!=m)switch(l={family:m,given:l},n.innerText){case r.Author:case r.Director:case r.Artist:case r.Writer:e.push(l);break;case r.Editor:h.push(l);break;case r.Translator:g.push(l)}}c.author=e;c.editor=h;c.translator=g;(d=a.querySelector(".dji-sru-edit-source-title-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.title=d.value);(d=a.querySelector(".dji-sru-edit-content-title-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c["container-title"]=
d.value);(d=a.querySelector(".dji-sru-edit-publisher-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.publisher=d.value);(d=a.querySelector(".dji-sru-edit-vol-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.volume=d.value);(d=a.querySelector(".dji-sru-edit-issue-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.issue=d.value);(d=a.querySelector(".dji-sru-edit-edition-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.edition=d.value);d=[];(e=a.querySelector(".dji-sru-edit-year-container>.dji-sru-edit-source-input"))&&
""!==e.value&&d.push(e.value);(e=a.querySelector(".dji-sru-edit-month-container>.dji-sru-edit-source-input"))&&""!==e.value&&d.push(e.value);(e=a.querySelector(".dji-sru-edit-day-container>.dji-sru-edit-source-input"))&&""!==e.value&&d.push(e.value);c.issued={};0<d.length&&(c.issued["date-parts"]=[d]);if(d=a.querySelector(".dji-sru-edit-season-container>.dji-sru-edit-source-input"))c.issued.season=d.value;(d=a.querySelector(".dji-sru-edit-no-pages-container>.dji-sru-edit-source-input"))&&""!==d.value&&
(c["number-of-pages"]=d.value);(d=a.querySelector(".dji-sru-edit-pages-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.page=d.value);(d=a.querySelector(".dji-sru-edit-ISSN-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.ISSN=d.value);(d=a.querySelector(".dji-sru-edit-ISBN-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.ISBN=d.value);(d=a.querySelector(".dji-sru-edit-DOI-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c.DOI=d.value);(d=a.querySelector(".dji-sru-edit-URL-container>.dji-sru-edit-source-input"))&&
""!==d.value&&(c.URL=d.value);(d=a.querySelector(".dji-sru-edit-city-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c["publisher-place"]=d.value);(d=a.querySelector(".dji-sru-edit-country-container>.dji-sru-edit-source-input"))&&""!==d.value&&(c["publisher-place"]=(c["publisher-place"]?c["publisher-place"]+", ":"")+d.value);(a=a.querySelector(".dji-sru-edit-medium-container>.dji-sru-edit-source-input"))&&""!==a.value&&(c.medium=a.value);b=__$(b).attr("dji-material");c.type=M[b].cslType;switch(b){case v.Movie:c.medium=
"Film"}f().source?f().source.update(c,!0):sru.outlinesDataManager.activeOutline().createSource(c,!1,f().topic);setTimeout(function(){Fa()},100)}function ca(a){if("keydown"==a.type&&13==a.keyCode){var b=a.target.value,c,d=f().querySelector(".dji-sru-material-selected");__$(d).hasClass("dji-sru-all")?c="any":__$(d).hasClass("dji-sru-book")?c="book":__$(d).hasClass("dji-sru-webpage")?c="webpage":__$(d).hasClass("dji-sru-journal")&&(c="journal");a.target.blur();__$.querySelector(".dji-sru-waiting").style.display=
"block";a=c;c=sru.outlinesDataManager.currentUiPathState();c.searchText=b;c.materialType=a;sru.outlinesDataManager.updateUiPathState(c);dji.utils.callListeners(F,"searchSources",{query:b,materialType:a})}else""!=a.target.value||"keydown"!=a.type&&"input"!=a.type||__$(f()).find(".dji-sru-searched-citations-container").empty()}function Fa(){dji.ui.pagination.previousPage(t,function(a){var b=a.querySelector(".dji-sru-page-content");f();__$(b).hasClass("dji-sru-sources")&&(b=b.querySelector("#dji_workaround-s000"),
Za(b,null,f().outline));a.topic=null;sru.outlinesDataManager.popUiPathState()})}function Ia(a){var b=a.currentTarget.parentNode.parentNode;__$(a.currentTarget).hasClass("dji-sru-ellipses")?b.querySelector(".dji-sru-intext-citation").innerHTML=b.fullIntextCitations+"<span class = 'dji-sru-collapse'></span>":b.querySelector(".dji-sru-intext-citation").innerHTML=b.partialIntextCitations;sru.searchInOutlineController.updatePageHighlight()}function ha(a){var b=dji.utils.closestParent(a.target,".dji-sru-outline-drag-item"),
c,d,e="dji-sru-template-outline-source"==b.getAttribute("dji-template-id");e?(c=".dji-sru-outline-source-content",d=".dji-sru-outline-source-bullet"):(c=".dji-sru-outline-topic-content",d=".dji-sru-outline-topic-bullet");var f=dji.utils.closestParent(a.target,c);f||(dji.utils.closestParent(a.target,d)?f=b.querySelector(c):a.target.nodeType==Node.ELEMENT_NODE&&(f=a.target.querySelector(c)));if(f)if(c=null,c=f.isContentEditable?dji.utils.documentForElement(f).getSelection().toString():f.innerText,0==
c.length)a.stopPropagation(),a.preventDefault();else return" "!=c.charAt(c.length-1)&&(c+=" "),a.stopPropagation(),a.dataTransfer.clearData(),f.isContentEditable||e||a.dataTransfer.setData("snap-read/topic-id",b.id),a.dataTransfer.setData("text/plain",c),e&&a.dataTransfer.setData("text/html",f.innerHTML),a.dataTransfer.setData("snap-read/has-text","true"),b=__$.querySelector("#dji-sru-drag-ghost"),b.innerText=c,a.dataTransfer.setDragImage(b,0,0),!0}function Dc(a){if(-1!=a.dataTransfer.types.indexOf("snap-read/topic-id"))return a.preventDefault(),
a.dataTransfer.dropEffect="move",(a=dji.utils.closestParent(a.target,"li"))&&dji.utils.addClassToElement(a,"dji-sru-topic-over"),!1}function jc(a){-1!=a.originalEvent.dataTransfer.types.indexOf("snap-read/topic-id")&&(a=dji.utils.closestParent(a.target,"li"))&&dji.utils.removeClassFromElement(a,"dji-sru-topic-over")}function Ec(a){if(-1!=a.dataTransfer.types.indexOf("snap-read/topic-id")){var b=dji.utils.closestParent(a.target,"li");dji.utils.removeClassFromElement(b,"dji-sru-topic-over");if(b.topic&&
(a=a.dataTransfer.getData("snap-read/topic-id"),a=__$.getElementById(a),a.previousSibling!==b||0!==b.querySelector("ul").childNodes.length)){var c=0<b.querySelector("ul").childNodes.length?b:b.parentNode.closest("li"),d;c?d=c.topic:(c=f().querySelector("#u000"),d=null);a.topic.moveTo(d,b.topic)&&ka(a,c,b)}}}function uc(a){if(-1!=a.dataTransfer.types.indexOf("snap-read/has-text")){var b=dji.utils.elementContext(a.srcElement);if(b&&b.isEditor&&(b.isGoogleDocsEditor||b.editor.focus(),b.isYahooMail||
b.isGoogleHangouts||b.isGoogleDocs&&b.isPlainEditor)){a.stopPropagation();a.preventDefault();if(b.isContentEditable){var c=b.document.caretRangeFromPoint(a.clientX,a.clientY);b.document.getSelection().setBaseAndExtent(c.startContainer,c.startOffset,c.endContainer,c.endOffset)}var d=a.dataTransfer.getData("text/plain");setTimeout(function(){dji.selectionMapper.insertText(b.editor,d,!1);if(b.isGoogleHangouts){var a=new KeyboardEvent("keypress",{bubbles:!0,cancelable:!0,key:" ","char":" "});b.editor.dispatchEvent(a)}},
0)}}}function lc(){O()}function mc(a){if(S)a.preventDefault(),a.stopPropagation();else{var b=a.target,c=b.parentNode;if(13===a.keyCode)a.preventDefault(),a.stopPropagation(),""!==b.innerHTML?setTimeout(function(){H(f(),c);var a=f().outline;a.isSkeleton()&&la(a,d)},0):(c===p&&(u=!0),ma(c),b.setAttribute("contenteditable",!0),setTimeout(function(){b.focus();u=!1},0));else if(9==a.keyCode)a.preventDefault(),c===p&&(u=!0),a.shiftKey?ma(c):ab(c),setTimeout(function(){b.setAttribute("contenteditable",!0);
b.focus();u=!1},100);else if(a.ctrlKey||a.metaKey)switch(String.fromCharCode(a.keyCode).toLowerCase()){case "b":a.preventDefault();sru.mainContainer.mainContainer().execCommand("bold",!1,null);break;case "i":a.preventDefault();sru.mainContainer.mainContainer().execCommand("italic",!1,null);break;case "u":a.preventDefault(),sru.mainContainer.mainContainer().execCommand("underline",!1,null)}else if(!(46==a.keyCode||8==a.keyCode||37<=a.keyCode&&40>=a.keyCode)){var d=b.innerText;2E3<=d.length&&(a.preventDefault(),
a.stopPropagation())}}}function nc(a){var b=a.target,c=!1,d=b.innerText,e=a.originalEvent.clipboardData.getData("text/plain");2E3<d.length+e.length&&(c=!0);c=c?2E3-d.length-e.length:e.length;e=b.innerHTML.toString().replace(/&nbsp\;/g," ")+e.slice(0,c);b.innerHTML=e;a.preventDefault();a.stopPropagation()}function oc(a){a=a.target;var b=a.innerHTML.toString();2E3<a.innerText.length&&(b=b.replace(/&nbsp\;/g," "),a.innerHTML=b.toString().slice(0,2E3))}function ab(a){var b=a.previousSibling;if(!b||b.topic){var c=
b?na(b):-1,d=na(a);11<d+1||d!==c||11==a.querySelectorAll("ul").length-1||(a.topic&&a.topic.indent(),ka(a,b,null))}}function na(a){for(var b=f().querySelector("#u000"),c=0;a.parentNode!==b;)c++,a=a.parentNode.parentNode;return c}function ka(a,b,c){var d=f().querySelector("#u000");b!==d&&(d=b.querySelector("ul"),d.style.display="block");!c||c!==b&&!c.nextSibling?d.appendChild(a):c===b?d.insertBefore(a,d.firstChild):d.insertBefore(a,c.nextSibling)}function ma(a){if(0!=na(a)){var b=f().querySelector("#u000");
a.topic&&a.topic.outdent();var c=a.parentNode.parentNode;ka(a,c.parentNode===b?b:c.parentNode.parentNode,c)}}function pc(a){var b=a.target,c=b.parentNode;if(!(u||p&&c==p&&u))if(dji.utils.documentForElement(a.target).getSelection().empty(),"0"===c.id)""===b.innerText?Y(f(),c):(a=f().outline,a.isSkeleton()&&la(a,b.innerText),setTimeout(function(){bb(c)},0));else if("0"!==c.id){b.setAttribute("contenteditable",!1);a=c.topic;var d=b.innerHTML.toString();""==b.innerText?a?Y(f(),c):c.remove():a&&0<d.length&&
(b.setAttribute("contenteditable","false"),a.body(d))}}function bb(a){var b=a.querySelector(".dji-sru-outline-topic-content"),c;c=(c=a.previousSibling)&&$(c).hasClass("dji-sru-outline-topic")?c.topic.location()+1:0;var d=null,e=a.parentNode;"u000"!=e.id&&(d=e.parentNode.topic);b=sru.outlinesDataManager.activeOutline().createTopic(b.innerHTML,c,d);a.id=b.uuid();a.topic=b;a===p&&(p=null);return a}function Ha(a){a=a.target;if(S)D(null,!1);else if(oa)N(null,!1);else{var b=a.closest(".dji-sru-outline-topic-content");
b&&(b.setAttribute("contenteditable",!0),sru.mainContainer.focus(function(){b.focus()}),J=b.parentNode)}}function Y(a,b){var c=$(a).find("#u000 .dji-sru-outline-topic").length;if("0"!=b.id||1!=c||a.querySelector("#u000").childNodes[0]!=b)b.parentNode.removeChild(b),b.topic?f().outline.deleteTopic(b.topic):(p=null,u=!1),0==$(a).find("#u000 .dji-sru-outline-topic").length&&H(a,null)}function kc(a){var b=$(a.target.parentNode).children(".dji-sru-outline-topic-content");""==b.text()&&b.is(":focus")&&
(u=!0);D(a.target.parentNode,!0)}function bc(a){a.preventDefault();a.stopPropagation();N(a.target.parentNode,!0)}function cb(a,b){var c=b.getBoundingClientRect(),d=c.left,e=c.top-62,h=a.querySelector(".dji-sru-pie-toolbar");h.style.left=d-49+"px";h.style.top=e+"px";a==m&&setTimeout(function(){var a=h.getBoundingClientRect().bottom,b=f().querySelector(".dji-sru-page-content"),c=b.getBoundingClientRect();if(a+10>c.bottom){var a=a-c.bottom+20,d=b.querySelector(".dji-sru-outline-content");d.removeEventListener("scroll",
T);h.style.top=e-a+"px";b.scrollTop+=a;setTimeout(function(){d.addEventListener("scroll",T)},100)}},0);__$(a).addClass("dji-visible")}function D(a,b){__$(f()).find(".dji-sru-outline-topic-content-active").removeClass("dji-sru-outline-topic-content-active");if(b){m.topicElement=a;var c=a.querySelector(".dji-sru-outline-topic-content");__$(c).addClass("dji-sru-outline-topic-content-active");""===c.innerText?$(m).find("#__dji_sru_linkButton").addClass("dji-disable"):$(m).find("#__dji_sru_linkButton").removeClass("dji-disable");
""!==c.innerText&&m.topicElement.topic?$(m).find("#__dji_sru_deleteTopicButton").removeClass("dji-disable"):$(m).find("#__dji_sru_deleteTopicButton").addClass("dji-disable");c=a.querySelector(".dji-sru-outline-topic-bullet");cb(m,c);setTimeout(function(){S=b},300)}else __$(m).removeClass("dji-visible"),S=!1,m.topicElement=!1}function rc(a){var b=$(m.topicElement).children(".dji-sru-outline-topic-content");a.target.id===Z["delete"]?!$(a.target).hasClass("dji-disable")&&m.topicElement.topic&&(Y(f(),
m.topicElement),D(null,!1),sru.searchInOutlineController.updatePageHighlight()):a.target.id===Z.indent?(ab(m.topicElement),D(m.topicElement,!0),sru.searchInOutlineController.updatePageHighlight()):a.target.id===Z.outdent?(ma(m.topicElement),D(m.topicElement,!0),sru.searchInOutlineController.updatePageHighlight()):a.target.id==Z.link?!$(a.target).hasClass("dji-disable")&&m.topicElement.topic&&(a=f().outline,b=m.topicElement.topic,sru.outlinesDataManager.pushOutlineLinkToSourceToStack(a,b),D(null,!1),
O(),sru.toolbar.enableHighlightButton(!1),Ic(a,b)):(b.focus(),D(null,!1),u=!1)}function N(a,b){if(oa=b){var c=a.querySelector(".dji-sru-outline-source-bullet"),d=$(E).find("#"+aa["delete"]),e=$(E).find("#"+aa.edit);d.removeClass("dji-disable");e.removeClass("dji-disabled");var f=a.source;f.data()&&f.cslData()||e.addClass("dji-disable");f.cslData()&&f.cslData().URL&&d.addClass("dji-disable");setTimeout(function(){cb(E,c)},0);E.sourceElement=a}else __$(E).removeClass("dji-visible")}function cc(a){if(!dji.utils.elementHasClass(a.target,
"dji-disable"))if(a.target.id===aa["delete"]){a=E.sourceElement;var b=a.source,c=a.parentNode;c.removeChild(a);c.hasChildNodes()||$(c.parentNode).addClass("dji-empty");sru.outlinesDataManager.activeOutline().deleteSource(b);da(f());N(null,!1);sru.searchInOutlineController.updatePageHighlight()}else a.target.id==aa.edit?(a=E.sourceElement.source,N(null,!1),O(),B({page:f(),show:!0,dlgMode:"edit-source",source:a,updateUIPathState:!0})):N(null,!1)}function db(a){dji.utils.elementHasClass(a.target,"dji-sru-close-btn")||
(a.preventDefault(),a.stopPropagation())}function vc(a){sru.toolbar.isHighlightActive()&&(a.target.closest(".kix-appview-editor")||(a.preventDefault(),a.stopPropagation()),eb())}function wc(a){a=a.target;var b=a.tagName?a.tagName.toLowerCase():null;return a.isContentEditable||a.tagName&&("textarea"==b||"input"==b)}function eb(a){var b=a;if(!b||0==b.length){if(a=fb())b=a.text;if(!b||0==b.length)return}p||H(f(),J);var c=p.querySelector(".dji-sru-outline-topic-content");c.innerHTML=b;__$.querySelector("html").hasAttribute("dji-sru-outline-active")&&
setTimeout(function(){c.focus()},0);a=sru.outlinesDataManager.activeOutline();a.isSkeleton()&&la(a,b);J=b=bb(p);var d=dji.utils.getMetadata();d.id="id0";d.type=M[v.Webpage].cslType;a.createSource(d,!0,b.topic);Wa(b.topic,b);ea(f())}function fb(){if(!Q||!n.isHighlightable())return null;var a={text:null,isTooLong:!1};try{var b=dji.selectionMapper.mapSelection();b&&(b.clearSelectionAtEnd=!1,dji.utils.preventInputEventsOnBodyElements(!0),a.text=(b.text||"").trim(),2E3<a.text.length&&(a.text=null,a.isTooLong=
!0,setTimeout(function(){alert("The text in your topic is too long.\nTry separating your text into more than one topic.")},0)),a.text&&(a.text='"'+a.text+'"'))}catch(c){b&&(b=null),dji.logger.error(c)}return a}function qc(a){var b=a.target.value.trim();a=f().outline.outlines(b);var c=sru.outlinesDataManager.currentUiPathState();c.searchText=b;sru.outlinesDataManager.updateUiPathState(c);b=f().querySelector(".dji-sru-outline-content");Sa(b);for(c=0;c<a.length;c++)K(b,a[c])}function Ja(a){var b=a.target;
"focusout"==a.type?setTimeout(function(){__$(b).addClass("dji-sru-outline-search-with-image")},0):"focusin"==a.type&&__$(b).removeClass("dji-sru-outline-search-with-image")}function sc(a){a.stopPropagation();a.preventDefault();for(var b=a.target.id,c=sru.outlinesDataManager.activeOutline().sources(),d=0;d<c.length&&c[d].uuid()!=b;d++);if(d<c.length){b=c[d].cslData();b.id="id0";var e=new Date,f=e.getMonth()+1,g=e.getDate(),e=[e.getFullYear(),f,g];b.accessed={};b.accessed["date-parts"]=[e];c[d].markAsModified()}(a=
a.toElement.getAttribute("href"))&&""!=a&&(window.location=a)}function la(a,b){b=b.trim().substr(0,33);var c=b.lastIndexOf(" ");b=-1==c?b.substr(0,32):b.substr(0,c);a.title(b);I(f(),b);sru.toolbar.setTitle(a)}function pa(){var a=[];$(f()).find(".dji-sru-page-content .dji-sru-folder-item.dji-selected").each(function(){a.push(this.outline)});return a}function Cc(){var a=[];$(f()).find(".dji-sru-page-content .dji-sru-folder-item.dji-selected").each(function(){a.push(this.outline.uuid())});return a}function Kc(){var a=
__$("#dji-sru-outline-source-dlg"),b=a.find(".dji-sru-tab-items");L(a,b);a.find(".dji-sru-page-content .dji-tab-item-view.dji-source-view").empty()}function qa(a,b,c,d){if(b&&0!=b.length)for(d=0;d<b.length;d++){var e=b[d],f=a.find(".dji-sru-form-line.dji-sru-page-source-author-line");f.addClass("dji-sru-hide-add-button");var g=$(dji.ui.templates.load(l,"dji-sru-template-page-source-author-line"));g.find(".dji-sru-combobox-contributors .dji-sru-combobox-label").text(c);g.find(".dji-sru-edit-fname-container input").val(e.given);
g.find(".dji-sru-edit-lname-container input").val(e.family);0==f.length?a.prepend(g):g.insertAfter(f.last())}}function gb(a,b,c){a=a.find(".dji-tab-item-view["+c+"]");a.find(".dji-sru-form-line.dji-sru-page-source-author-line").remove();var d=!1;b.hasOwnProperty("author")&&(qa(a,b.author,r.Author,c),0!=b.author.length&&(d=!0));b.hasOwnProperty("editor")&&(qa(a,b.editor,r.Editor,c),0!=b.editor.length&&(d=!0));b.hasOwnProperty("translator")&&(qa(a,b.translator,r.Translator,c),0!=b.translator.length&&
(d=!0));d||(c=$(dji.ui.templates.load(l,"dji-sru-template-page-source-author-line")),a.prepend(c));for(var e in b)switch(e){case "publisher-place":c=b[e].split(", ");a.find("input[dji-csl-item="+e+"]").val(c[0]);1<c.length&&a.find("input[dji-csl-add-to-item="+e+"]").val(c[1]);break;default:a.find("input[dji-csl-item="+e+"]").val(b[e])}b.hasOwnProperty("issued")&&(b=b.issued,b.hasOwnProperty("year")&&a.find("input[dji-csl-item-year]").val(b.year),b.hasOwnProperty("month")&&a.find("input[dji-csl-item-month]").val(b.month),
b.hasOwnProperty("day")&&a.find("input[dji-csl-item-day]").val(b.day))}function Lc(a,b){var c;c=a.find(".dji-sru-tab-items .dji-sru-tab-item").last();switch(b){case "dji-sru-outline-source-book":case "dji-sru-outline-source-webpage":c.text("JOURNAL");c.attr("dji-item","dji-sru-outline-source-journal");break;default:c.text(M[b].tabName.toUpperCase()),c.attr("dji-item",b)}a.find(".dji-sru-tab-items .dji-sru-tab-item[dji-item="+b+"]").addClass("dji-selected")}function hb(a,b,c){b=b.cslData();var d=ib[b.type];
c=c||d;A(a,c,!0);d!=c&&(c=a.find(".dji-tab-item-view["+d+"]"),Ta(c,d));gb(a,b,d);return d}function B(a){var b=__$("#dji-sru-outline-source-dlg");a.show?(a.source?(b.find(".dji-sru-page-toolbar-line1 .dji-sru-folder-page-info").text("Edit Source"),b.attr("dji-sru-mode",a.dlgMode),a.page.source=a.source,a.selTabItem?(hb(b,a.source,a.selTabItem),A(b,a.selTabItem,!0)):a.selTabItem=hb(b,a.source,a.selTabItem)):(b.find(".dji-sru-page-toolbar-line1 .dji-sru-folder-page-info").text("New Source"),b.attr("dji-sru-mode",
a.dlgMode),a.selTabItem=a.selTabItem||"dji-sru-outline-source-book",A(b,a.selTabItem,!0)),Lc(b,a.selTabItem),b.on("keydown",jb),b.addClass("dji-visible"),setTimeout(function(){b.focus()},0)):(b.off("keydown",jb),b.removeClass("dji-visible"),a.page.source=null,Kc());if(a.updateUIPathState){var c=sru.outlinesDataManager.currentUiPathState();a.show?(c.lastView=c.view,c.view="source",c.dlgMode=a.dlgMode,c.sourceTabItem=a.selTabItem,a.source&&(c.uuidSource=a.source.uuid())):(c.view=c.lastView,delete c.lastView,
c.source&&delete c.source,delete c.sourceTabItem);sru.outlinesDataManager.updateUiPathState(c)}}function kb(a,b,c){var d=!1;if(null==b)d=c&&"home"==c,K(a,sru.outlinesDataManager.home(),d),__$("#dji-sru-outline-move-to-dlg").attr("dji-home-folder","");else{var e=b.outlines("");e.sort(function(a,b){return a.title().toLowerCase()>b.title().toLowerCase()?1:a.title().toLowerCase()<b.title().toLowerCase()?-1:0});for(var f=0;f<e.length;f++)b=e[f],b.isDirectory()&&(d=b.uuid()==c,K(a,b,d));__$("#dji-sru-outline-move-to-dlg").removeAttr("dji-home-folder",
"")}}function ra(a,b,c){var d=__$("#dji-sru-outline-move-to-dlg .dji-sru-page-content");d.empty();var e=fa(b);__$("#dji-sru-outline-move-to-dlg .dji-sru-page-toolbar-line2 .dji-sru-folder-page-info").html(e);kb(d[0],b,c);d=a.find(".dji-sru-tb-button.dji-sru-outline-new-folder");a.data("outline",b);null==b?d.addClass("dji-disable"):d.removeClass("dji-disable");c?__$("#dji-sru-outline-move-to-dlg-done").removeClass("dji-disable"):__$("#dji-sru-outline-move-to-dlg-done").addClass("dji-disable")}function z(a){var b=
__$("#dji-sru-outline-move-to-dlg");if(a.show){var c=a.outline||null,d=a.selOutline||null;ra(b,c,d);b.on("keydown",lb);b.addClass("dji-visible");setTimeout(function(){b.focus()},0)}else b.off("keydown",lb),b.removeClass("dji-visible"),__$("#dji-sru-outline-move-to-dlg .dji-sru-page-content").empty(),__$("#dji-sru-outline-move-to-dlg-done").addClass("dji-disable");if(a.updateUIPathState){var e=sru.outlinesDataManager.currentUiPathState();a.show?(e.view="moveTo",e.moveToOutline=c?c.uuid():null,d&&(e.moveToSelOutline=
d.uuid())):(e.view="outline",delete e.moveToOutline,delete e.moveToSelOutline);sru.outlinesDataManager.updateUiPathState(e)}}function x(a,b){function c(){if(b.doneCallback&&$.isFunction(b.doneCallback)){var a=f.val().trim();b.doneCallback(a,function(a){a&&!a.error&&x(!1)})}else x(!1)}function d(a){13==a.keyCode?g.click():27==a.keyCode&&x(!1)}var e=__$("#dji-folder-page-template-dlg-1"),f=e.find("#dji-folder-page-template-dlg-1-input"),g=e.find("#dji-folder-page-template-dlg-1-done");a?(e.find(".dji-sru-dialog-title").text(b.title),
f.attr("placeholder",b.placeholder).val(b.value),g.text(b.doneBtnText).click(c),e.on("keydown",d),e.addClass("dji-visible"),setTimeout(function(){f.focus();b.highlight&&f.select()},0)):(e.find("#dji-folder-page-template-dlg-1-done").off("click"),e.off("keydown",d),e.removeClass("dji-visible"))}function V(a,b){var c=__$("#dji-folder-page-delete-outline-dlg");a?(c.on("keydown",mb),c.addClass("dji-visible"),setTimeout(function(){c.focus()},0)):(c.off("keydown",mb),c.removeClass("dji-visible"))}function wb(){$(f()).find(".dji-sru-folder-page").attr("dji-sru-search-outlines",
!0);setTimeout(function(){__$("input[dji-sru-search-outlines-input]").focus()},0)}function wa(){$(f()).find(".dji-sru-folder-page").removeAttr("dji-sru-search-outlines");xa()}function xa(){var a=$(f()).find(".dji-sru-folder-page .dji-sru-search-container");a.removeAttr("dji-sru-show-result");a.find(".dji-sru-search-result").empty();__$("input[dji-sru-search-outlines-input]").val("")}function vb(a){a=$(a.currentTarget).val();a=a.trim().toLowerCase();if(""==a)$(f()).find(".dji-sru-folder-page .dji-sru-search-container").removeAttr("dji-sru-show-result");
else{a=f().outline.outlines(a);var b=$(f()).find(".dji-sru-folder-page .dji-sru-search-result");b.empty();if(a&&a.length){for(var c=0;c<a.length;c++){var d=b,e=a[c],h=e.isHome()?"dji-sru-folder-item-home":e.isDirectory()?"dji-sru-folder-item-subfolder":"dji-sru-folder-item-outline",h=dji.ui.templates.load(l,h);h.outline=e;h.id=e.uuid();h=$(h);if(!e.isHome()){var g=new Date(e.modifiedDate()),k=g.getMonthName("en"),m=g.getDate(),g=g.getFullYear(),k=k+" "+m+", "+g;h.find(".dji-sru-folder-item-name").text(e.title());
h.find(".dji-sru-folder-item-date").text(k)}h.addClass("dji-sru-search-folder-item").removeClass("dji-sru-folder-item");d.append(h)}$(f()).find(".dji-sru-folder-page .dji-sru-search-container").attr("dji-sru-show-result","")}else $(f()).find(".dji-sru-folder-page .dji-sru-search-container").removeAttr("dji-sru-show-result")}}function sa(a,b){var c=!1,d=a.find(".dji-sru-outline-page .dji-sru-search-container .dji-sru-search-result");d.empty();b=(b||"").toLowerCase();for(var e in ba)""==b?(c=!0,$("<div/>",
{"class":"dji-sru-search-outline-template",text:e}).data("dji-outline-template",ba[e]).appendTo(d)):-1!=e.toLowerCase().indexOf(b)&&(c=!0,$("<div/>",{"class":"dji-sru-search-outline-template",text:e}).data("dji-outline-template",ba[e]).appendTo(d));c?$(f()).find(".dji-sru-outline-page .dji-sru-search-container").attr("dji-sru-show-result",""):$(f()).find(".dji-sru-outline-page .dji-sru-search-container").removeAttr("dji-sru-show-result")}function Ac(a){$(a.currentTarget).hasClass("dji-disable")?(a.preventDefault(),
a.stopPropagation()):(a=$(f()),sa(a,""),$(f()).find(".dji-sru-outline-page").attr("dji-sru-search-outline-template",!0),setTimeout(function(){$(f()).find("input[dji-sru-search-outline-template-input]").focus()},0))}function ya(){$(f()).find(".dji-sru-outline-page").removeAttr("dji-sru-search-outline-template");za()}function za(){$(f()).find("input[dji-sru-search-outline-template-input]").val("");sa($(f()),"")}function Eb(a){a=$(a.currentTarget).val().trim();sa($(f()),a)}function nb(a,b,c,d){b=a.createTopic(c.body,
d,b);for(d=0;d<c.children.length;d++)nb(a,b,c.children[d],d)}function Fb(a){a=$(a.currentTarget).data("dji-outline-template");for(var b=f().outline,c=$(f()).find(".dji-sru-page-content #u000.dji-sru-outline-list").children(".dji-sru-outline-topic:last-child")[0],c=c.topic?c.topic.location()+1:-1,d=0;d<a.length;d++){var e=a[d];b.isSkeleton()&&(b.title(e.body),I(f(),e.body),sru.toolbar.setTitle(b));for(var h=b.createTopic(e.body,c,null),g=0;g<e.children.length;g++)nb(b,h,e.children[g],g);c++}da(f());
ya()}function xc(){__$("#dji-sru-outline-source-dlg").attr("dji-sru-search-sources",!0);setTimeout(function(){__$("input[dji-sru-search-sources-input]").focus()},0)}function Ba(){__$("#dji-sru-outline-source-dlg").removeAttr("dji-sru-search-sources");Ca()}function Ca(){__$("#dji-sru-outline-source-dlg").find(".dji-sru-search-container").removeAttr("dji-sru-show-result");__$("#dji-sru-outline-source-dlg input[dji-sru-search-sources-input]").val("")}function Rb(a){13==a.keyCode&&(a=$(a.currentTarget).val().trim(),
""!=a&&(a={query:a,materialType:"all"},sru.mainContainer.enterBusyState(),dji.utils.callListeners(F,"searchSources",a)))}function Sb(a){var b=$(a.currentTarget).data("dji-source");if(b){a=__$("#dji-sru-outline-source-dlg");var b=b.cslData,c=ib[b.type],d=a.find(".dji-sru-tab-items .dji-sru-tab-item.dji-selected");d.attr("dji-item")!=c&&L(a,d.parent());A(a,c,!0);gb(a,b,c);Ba()}}function Cb(){$(f()).find(".dji-sru-outline-page").attr("dji-sru-search-in-topics",!0);sru.searchInOutlineController.init(f());
setTimeout(function(){__$("input[dji-sru-search-in-topic-input]").focus()},0)}function Db(a){a=$(a.currentTarget).val().trim();sru.searchInOutlineController.mark(a)}function O(){$(f()).find(".dji-sru-outline-page").removeAttr("dji-sru-search-in-topics");__$("input[dji-sru-search-in-topic-input]").val("");sru.searchInOutlineController.reset()}function dc(a){a=$(a.currentTarget).attr("dji-sru-source-dlg");B({page:f(),show:!0,selTab:"dji-sru-outline-source-book",dlgMode:a,updateUIPathState:!0})}function Ma(a){if(W!=
a.data){var b=sru.outlinesDataManager.currentUiPathState();W=b.outlineViewMode=a.data;$(t).find(".dji-sru-page .dji-sru-folder-page").each(function(){w(this.parentNode,"")});sru.outlinesDataManager.updateUiPathState(b)}}function ob(a,b){var c=f().outline;a&&""!=a?(c.title(a),sru.toolbar.setTitle(c),c.isDirectory()?(c=fa(c),I(f(),c,!0)):I(f(),c.title()),b({error:0,message:"Outline title has been changed!!!"})):b({error:500,message:"Invalid title!!!"})}function Mc(a,b){if(!G)return b({error:500,message:"No outline selected!!!"});
a&&""!=a?(G.title(a),$(f()).find("#"+G.uuid()+" .dji-sru-folder-item-info .dji-sru-folder-item-name").text(a),b({error:0,message:"Outline title has been changed!!!"})):b({error:500,message:"Invalid title!!!"})}function ta(a){$(a.currentTarget).hasClass("dji-disable")?(a.preventDefault(),a.stopPropagation()):(a={title:"Rename",value:f().outline.title(),placeholder:"Outline Name",highlight:!0,doneBtnText:"RENAME",doneCallback:ob},x(!0,a))}function yc(a){$(a.currentTarget).hasClass("dji-disable")?(a.preventDefault(),
a.stopPropagation()):(a={title:"Rename",value:G.title(),placeholder:"Outline Name",highlight:!0,doneBtnText:"RENAME",doneCallback:Mc},x(!0,a))}function Nc(a,b){if(a&&""!=a){var c=f().outline;c.isHome()&&(c=null);sru.outlinesDataManager.createDirectory(a,c);w(f());b({error:0,message:"Folder has been created!!!"})}else b({error:500,message:"Invalid folder name!!!"})}function Hb(a,b){if(a&&""!=a){var c=__$("#dji-sru-outline-move-to-dlg"),d=c.data("outline"),e=d.isHome()?null:d,h=f().outline;sru.outlinesDataManager.createDirectory(a,
e);(h.isHome()&&null==e||h.uuid()==e.uuid())&&w(f());c=c.find(".dji-sru-page-content");c.empty();e=sru.outlinesDataManager.currentUiPathState();kb(c[0],d,e.moveToSelOutline);b({error:0,message:"Folder has been created!!!"})}else b({error:500,message:"Invalid folder name!!!"})}function Jb(a){a=a.currentTarget.outline;var b=__$("#dji-sru-outline-move-to-dlg");b.data("outline",a);ra(b,a,null);b=sru.outlinesDataManager.currentUiPathState();b.moveToOutline=a?a.isHome()?"home":a.uuid():null;b.moveToSelOutline=
null;sru.outlinesDataManager.updateUiPathState(b)}function Kb(a){var b=a.currentTarget.outline,c=sru.outlinesDataManager.currentUiPathState();$(a.currentTarget).hasClass("dji-selected")?($(a.currentTarget).removeClass("dji-selected"),__$("#dji-sru-outline-move-to-dlg-done").addClass("dji-disable"),c.moveToSelOutline=null):($(a.currentTarget).parent().find(".dji-sru-folder-item").removeClass("dji-selected"),$(a.currentTarget).addClass("dji-selected"),__$("#dji-sru-outline-move-to-dlg-done").removeClass("dji-disable"),
c.moveToSelOutline=b.isHome()?"home":b.uuid());sru.outlinesDataManager.updateUiPathState(c)}function lb(a){if(13==a.keyCode){if(!__$("#dji-sru-outline-move-to-dlg-done").hasClass("dji-disable")){var b=pa(),c=__$("#dji-sru-outline-move-to-dlg .dji-sru-page-content .dji-sru-folder-item.dji-selected")[0].outline;sru.outlinesDataManager.moveOutlines(b,c);w(f());z({show:!1,updateUIPathState:!0})}a.preventDefault();a.stopPropagation()}else 27==a.keyCode&&(z({show:!1,updateUIPathState:!0}),a.preventDefault(),
a.stopPropagation())}function Ib(){var a=__$("#dji-sru-outline-move-to-dlg").data("outline"),a=a.isHome()?null:a.parent(),b=__$("#dji-sru-outline-move-to-dlg");ra(b,a,null);b=sru.outlinesDataManager.currentUiPathState();b.moveToOutline=a?a.isHome()?"home":a.uuid():null;b.moveToSelOutline=null;sru.outlinesDataManager.updateUiPathState(b)}function Lb(a){if($(a.currentTarget).hasClass("dji-disable"))a.preventDefault(),a.stopPropagation();else{a=pa();var b=__$("#dji-sru-outline-move-to-dlg .dji-sru-page-content .dji-sru-folder-item.dji-selected")[0].outline;
sru.outlinesDataManager.moveOutlines(a,b);w(f());z({show:!1,updateUIPathState:!0})}}function xb(){x(!0,{title:"New Folder",value:"New Folder",placeholder:"Folder Name",doneBtnText:"CREATE FOLDER",doneCallback:Nc})}function ua(){var a={title:"Rename Outline",value:f().outline.title(),placeholder:"Outline Name",highlight:!0,doneBtnText:"RENAME",doneCallback:ob};x(!0,a)}function mb(a){13==a.keyCode?(Ea(),a.stopPropagation(),a.preventDefault()):27==a.keyCode&&(Da(),a.stopPropagation(),a.preventDefault())}
function Da(){f().outline.title("Outline Name");V(!1);dji.ui.pagination.previousPage(t,function(a){w(a);sru.outlinesDataManager.popOutlineFromStack();sru.toolbar.setTitle(a.outline)})}function Ea(){var a=f().outline;V(!1);dji.ui.pagination.previousPage(t,function(b){b.outline.deleteOutlines([a]);sru.outlinesDataManager.popOutlineFromStack();sru.toolbar.setTitle(b.outline)})}function Na(a){$(a.currentTarget).hasClass("dji-disable")?(a.preventDefault(),a.stopPropagation()):z({show:!0,outline:null,updateUIPathState:!0})}
function Oa(a){$(a.currentTarget).hasClass("dji-disable")?(a.preventDefault(),a.stopPropagation()):(a=pa(),0<a.length&&(f().outline.deleteOutlines(a),w(f())))}function Ab(a){a.preventDefault();a.stopPropagation();a=f();var b=$(a).find(".dji-sru-page-content ul#u000 li.dji-sru-outline-topic"),c=b.find(".dji-sru-outline-topic-content");if(""==c.text()&&1==b.length)c.click();else if(b=$(a).find(".dji-sru-page-content ul#u000 li.dji-sru-outline-topic .dji-sru-outline-topic-content:focus").first(),0==
b.length||""!=b.text())c=null,0!=b.length&&(c=b[0].parentNode),H(a,c)}function yb(){if(G=f().outline){var a=__$("#dji-sru-folder-page-context-menu");0!=$(f()).find(".dji-sru-folder-item.dji-selected").length?(__$("#dji-sru-folder-page-move-to-outline-items").removeClass("dji-disable"),__$("#dji-sru-folder-page-delete-outline-items").removeClass("dji-disable")):(__$("#dji-sru-folder-page-move-to-outline-items").addClass("dji-disable"),__$("#dji-sru-folder-page-delete-outline-items").addClass("dji-disable"));
a.addClass("dji-visible")}}function zb(){var a=f();if(G=a.outline)"dji-sru-outline-details"==$(a).find(".dji-sru-page-toolbar .dji-sru-tab-items .dji-sru-tab-item.dji-selected").attr("dji-item")?__$("#dji-sru-search-outline-template").removeClass("dji-disable"):__$("#dji-sru-search-outline-template").addClass("dji-disable"),__$("#dji-sru-outline-page-context-menu").addClass("dji-visible")}function jb(a){13==a.keyCode?Aa():27==a.keyCode&&B({page:f(),show:!1,updateUIPathState:!0})}function Mb(){__$(".dji-sru-tab-item-more[dji-item=dji-sru-outline-source-more]").addClass("dji-dropdown");
__$("#dji-sru-outline-new-source-more-context-menu").addClass("dji-visible")}function Nb(a){$(a.currentTarget).find(".dji-sru-contributors-selection").addClass("dji-visible")}function Pb(a){var b=$(a.currentTarget),c=b.parent().parent(),b=b.attr("dji-value");c.find(".dji-sru-combobox-label").text(b);c.find(".dji-sru-contributors-selection").removeClass("dji-visible");a.preventDefault();a.stopPropagation()}function Qb(){var a=__$("#dji-sru-outline-source-dlg").find(".dji-tab-item-view.dji-source-view.dji-visible .dji-sru-form-line.dji-sru-page-source-author-line");
if(!(3<=a.length)){a.addClass("dji-sru-hide-add-button");var b=dji.ui.templates.load(l,"dji-sru-template-page-source-author-line");$(b).insertAfter(a.last())}}function Ob(a){$(a.currentTarget).find(".dji-sru-contributors-selection").removeClass("dji-visible")}function Vb(a){var b=$(a.target);if(!b.hasClass("dji-selected")){a=b.attr("dji-item");var c=__$("#dji-sru-outline-source-dlg");L(c,b.parent());A(c,a,!0);b=sru.outlinesDataManager.currentUiPathState();b.sourceTabItem=a;sru.outlinesDataManager.updateUiPathState(b)}}
function zc(a){a=$(a.currentTarget);var b=__$("#dji-sru-outline-source-dlg"),c=b.find(".dji-sru-tab-items .dji-sru-tab-item[dji-item="+a.attr("dji-item")+"]");if(0==c.length)c=b.find(".dji-sru-tab-items .dji-sru-tab-item").last(),L(b,c.parent()),c.text(a.attr("dji-item-text")),c.attr("dji-item",a.attr("dji-item"));else{if(c.hasClass("dji-selected"))return;L(b,c.parent())}A(b,a.attr("dji-item"),!0);b=sru.outlinesDataManager.currentUiPathState();b.sourceTabItem=a.attr("dji-item");sru.outlinesDataManager.updateUiPathState(b)}
var F={searchSources:[],options:[],signOut:[]},l=null,pb=!1,t;p=null;u=void 0;var S=!1,oa=!1,m,E,J=null,ba=null,U={recent:1,alphabetical:2},W=U.alphabetical,Z={indent:"__dji_sru_indentButton",outdent:"__dji_sru_outdentButton",link:"__dji_sru_linkButton","delete":"__dji_sru_deleteTopicButton"},aa={edit:"__dji_sru_editSourceButton","delete":"__dji_sru_deleteSourceButton"},v={Book:"dji-sru-outline-source-book",Journal:"dji-sru-outline-source-journal",Webpage:"dji-sru-outline-source-webpage",Movie:"dji-sru-outline-source-movie",
Magazine:"dji-sru-outline-source-magazine",Newspaper:"dji-sru-outline-source-newspaper",Television:"dji-sru-outline-source-tv-radio",Visual:"dji-sru-outline-source-visual-art"},M={"dji-sru-outline-source-book":{tabName:"Book",cslType:"book"},"dji-sru-outline-source-journal":{tabName:"Journal",cslType:"article-journal"},"dji-sru-outline-source-webpage":{tabName:"Website",cslType:"webpage"},"dji-sru-outline-source-movie":{tabName:"Movie",cslType:"motion_picture"},"dji-sru-outline-source-magazine":{tabName:"Magazine",
cslType:"article-magazine"},"dji-sru-outline-source-newspaper":{tabName:"Newspaper",cslType:"article-newspaper"},"dji-sru-outline-source-tv-radio":{tabName:"TV/Radio",cslType:"broadcast"},"dji-sru-outline-source-visual-art":{tabName:"Visual Art",cslType:"graphic"}},ib={book:"dji-sru-outline-source-book",journal:"dji-sru-outline-source-journal","article-journal":"dji-sru-outline-source-journal",webpage:"dji-sru-outline-source-webpage",movie:"dji-sru-outline-source-movie",motion_picture:"dji-sru-outline-source-movie",
magazine:"dji-sru-outline-source-magazine","article-magazine":"dji-sru-outline-source-magazine",newspaper:"dji-sru-outline-source-newspaper","article-newspaper":"dji-sru-outline-source-newspaper",television:"dji-sru-outline-source-tv-radio",broadcast:"dji-sru-outline-source-tv-radio",visual:"dji-sru-outline-source-visual-art",graphic:"dji-sru-outline-source-visual-art"},r={Author:"Author",Editor:"Editor",Translator:"Translator",Compiler:"Compiler",Director:"Director",Artist:"Artist",Writer:"Writer"},
Hc,R,Q=!1,G=null;y=null;n.activateHighlight=function(a){(Q=a)?(dji.utils.preventInputEventsOnBodyElements(!0),dji.utils.addEventListenerToBodyElements("click",db,!0),dji.utils.addClassToHtmlElements("dji-sru-outline-highlight-active")):(dji.utils.removeClassFromHtmlElements("dji-sru-outline-highlight-active"),dji.utils.preventInputEventsOnBodyElements(!1),dji.utils.removeEventListenerFromBodyElements("click",db,!0))};n.isHighlightActive=function(){return Q};n.initialize=function(){pb||(l=dji.ui.templates.source("__dji_sru_link_outlines"),
t=sru.mainContainer.mainContainer().querySelector(".dji-sru-pagination-container"),R=dji.ui.templates.load(l,"template-page-sources-popup"),R.id="dji-sru-sources-popup",__$.querySelector("#__dji_sru_main_container_content").appendChild(R),dji.ui.pagination.initializeContainer(t,{source:l,name:"template-page"}),m=__$.getElementById("dji-sru-topics-toolbar"),E=__$.getElementById("dji-sru-sources-toolbar"),qb(),pb=!0,dji.logger.log("Outlines initialized"))};n.setData=function(a,b){sru.outlinesDataManager.setData(a,
b);Pa()};n.updateData=function(a,b){var c=sru.outlinesDataManager.updateData(a,b);c&&(c.updateInfo&&(c.updateInfo.topOutline||c.updateInfo.topDirectory||c.updateInfo.topTopic)||c.deleteInfo&&(c.deleteInfo.topOutline||c.deleteInfo.topDirectory||c.deleteInfo.topTopic||c.deleteInfo.topSource))&&Pa()};n.createEmptyTopic=function(){H(f())};n.hideBulletToolbars=function(){oa&&N(null,!1);S&&D(null,!1)};n.removeSelectionView=function(){Xa();var a=f();w(a)};n.updateSelectionView=function(){var a=f();w(a)};
n.displaySources=function(a,b,c){if("OL"==c){b=(b||f()).querySelector(".dji-sru-searched-citations-container");__$(b).empty();for(var d=0;d<a.length;d++){var e=dji.ui.templates.load(l,"template-page-citation-searched-element");e.source=a[d].cslData;for(var h="",g=0;g<a[d].cslData.author.length;g++)h=h+a[d].cslData.author[g].given+" "+a[d].cslData.author[g].family+(g==a[d].cslData.author.length-1?"":", ");e.querySelector(".dji-sru-citation-author").innerText=h;e.querySelector(".dji-sru-citation-title").innerText=
a[d].cslData.title;e.querySelector(".dji-sru-citation-tooltip").innerHTML=a[d].text;b.appendChild(e)}}else for(b=(b||f()).querySelector(".dji-sru-searched-citations-container"),__$(b).empty(),d=0;d<a.length;d++)e=dji.ui.templates.load(l,"template-page-citation-searched-element"),e.source=a[d],e.querySelector(".dji-sru-citation-author").innerText=a[d].authors,e.querySelector(".dji-sru-citation-title").innerText=a[d].title,e.querySelector(".dji-sru-citation-tooltip").innerHTML=a[d].citation.APA,b.appendChild(e);
__$.querySelector(".dji-sru-waiting").style.display="none";b=sru.outlinesDataManager.currentUiPathState();b.dataType=c;b.data=a;sru.outlinesDataManager.updateUiPathState(b);__$.querySelector(".dji-sru-waiting").style.display="none"};n.startHighlight=function(){var a=fb();if(!a||!(a.isTooLong||a.text&&0!=a.text.length))return!1;a.isTooLong||eb(a.text);setTimeout(function(){n.activateHighlight(!1);sru.toolbar.activateHighlightButton(!1)},100);return!0};n.endHighlight=function(){J=null};n.isHighlightable=
function(){if(!f())return!1;var a=f().children[0];return"dji-template-sru-outline-page"==a.getAttribute("dji-template-id")&&!$(a).hasClass("dji-sru-sources")};n.searchSourcesFinished=function(a,b){var c;if(a)if("OL"==b){c=[];for(var d=0;d<a.length;d++){var e=a[d];e.id="id0";e.type="book";source={};source.cslData=e;source.text=sru.citations.generateCition(e,"apa","en-US");c.push(source)}}else c=a;else c=[];n.displaySources(c,null,b);f().querySelector("#__dji_sru_searchSource").focus()};n.addEventListener=
function(a,b){F.hasOwnProperty(a)&&"function"==typeof b&&-1==F[a].indexOf(b)&&F[a].push(b)};n.closeAllPopups=function(){Ka()};n.onSearchSourcesFinished=function(a,b){var c;if(a)if("OL"==b){c=[];for(var d=0;d<a.length;d++){var e=a[d];e.id="id0";e.type="book";g={};g.cslData=e;g.text=sru.citations.generateCition(e,"apa","en-US");c.push(g)}}else c=a;else c=[];e=__$("#dji-sru-outline-source-dlg");if(0==c.length)e.find(".dji-sru-search-container").removeAttr("dji-sru-show-result"),e.find(".dji-sru-search-container .dji-sru-search-result").empty();
else{var f=e.find(".dji-sru-search-container .dji-sru-search-result");f.empty();for(d=0;d<c.length;d++){var g=c[d],k=$("<div/>",{"class":"dji-sru-search-source"});k.data("dji-source",g);k.html(g.text);f.append(k)}e.find(".dji-sru-search-container").attr("dji-sru-show-result",!0)}sru.mainContainer.leaveBusyState()};n.outlineTemplates=function(a){ba=a}})(window.sru.outlines=window.sru.outlines||{});
