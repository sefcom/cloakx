(function(){hubspot.require(["sidekick.chrome.utils.console","SignalsExtension/config/context"],function(e,n){var t,i,o;t="https://mail.google.com/_/scs/mail-static";i=["InboxSDK Implementation Version"];o=[RegExp("chrome-extension://"+chrome.runtime.id)];return $(function(){var r,s;r={ignoreErrors:i,includePaths:o,dataCallback:function(e){var n;n=e.stacktrace;if(null==(null!=n?n.frames:void 0))return e;n.frames=_.reject(n.frames,function(e){var n;n=e.filename;return-1!==n.indexOf(t)});return e},release:chrome.runtime.getManifest().version};s="https://ca51b55e85514c39bb26d69b40c4621b@app.getsentry.com/20529";Raven.config(s,r).install();window.onerror=function(n){return function(){e.error.apply(e,arguments);return Raven.process.apply(n,arguments)}}(this);e.log("Raven initialized");return"background"===n?hubspot.require(["_","enviro","hubspot.HublyticsTrackerJS.SidekickTracker","SignalsExtension/data/salesGates"],function(n,t,i,o){chrome.runtime.onMessage.addListener(function(n,t,i){if("trackJsonAction"===n.method){trackJsonAction(n.action,n.props);e.debug("Tracking JSON Action "+n.action+" "+JSON.stringify(n.props));i({})}});return window.trackJsonAction=function(e,n){var o;null==n&&(n={});if(t.deployed("hublyticstrackerjs")){o=null!=n.what_extra_json||null!=n.what_event_subtype||null!=n.what_value_str?n:{what_extra_json:n};return i.trackInteraction(e,o)}}}):void 0})})}).call(this);(function(){hubspot.define("sidekick.chrome.utils.Bucky",["sidekick.chrome.constants.bucky","sidekick.chrome.bucky.eventsManager","sidekick.chrome.bucky.client","sidekick.chrome.bucky.memoryLogger","SignalsExtension/config/context"],function(e,n,t,i,o){var r,s;s=e.SEND_PAGE_PERF;if(s){t.get().sendPagePerformance("page");i.start()}r={};if("background"!==o){r.client=t;r.eventsManager=n}return r})}).call(this);(function(){hubspot.define("sidekick.chrome.bucky.client",["sidekick.chrome.constants.bucky","Bucky"],function(e,n){var t,i,o,r,s,a;i=e.BUCKY_SERVER,o=e.NAMESPACE,t=e.ACTIVE;n.setOptions({host:i,active:t,sample:.6});r=function(){var e;e=moment.duration(performance.now());return Math.floor(e.asHours())};s=_.once(function(){return n(o)});a=_.memoize(function(){var e;e=r();return n(o+"."+e+"h")},r);return{get:s,getWithProcessAge:a}})}).call(this);(function(){hubspot.define("sidekick.chrome.bucky.eventsManager",["sidekick.chrome.bucky.client"],function(e){var n,t,i;n="compose.new";t={newCompose:{isPending:!1,stopwatch:{}}};i={start:function(){var i;i=e.getWithProcessAge().timer;return t.newCompose={isPending:!0,stopwatch:i.stopwatch(n)}},mark:function(e){return t.newCompose.isPending===!0?t.newCompose.stopwatch.mark(e):void 0},done:function(){return t.newCompose.isPending=!1}};return{newCompose:i}})}).call(this);(function(){hubspot.define("sidekick.chrome.bucky.memoryLogger",["_","sidekick.chrome.bucky.client"],function(e,n){var t,i,o,r,s,a,u,c,l,d;o=6e4;i=60*o;t=15*o;l=0;d=function(){return e.delay(c,o)};c=function(){a();return setInterval(s,t)};a=function(){var e,t,i,o,s;i=n.getWithProcessAge().send;t=performance.memory,e=t.jsHeapSizeLimit,o=t.totalJSHeapSize,s=t.usedJSHeapSize;i("memory.limit",r(e));i("memory.total",r(o));i("memory.used",r(s));return u()};s=function(){var e;e=+new Date-l;return e>i?a():void 0};r=function(e){return e/1e3/1e3};u=function(){return l=+new Date};return{start:d}})}).call(this);hubspot.define("SignalsExtension/api/DoNotDisturbApi",["SignalsExtension/api/SidekickAppHttpClient"],function(e){"use strict";var n={},t=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(n,"__esModule",{value:!0});var i=t(e),o=function(){return i.get("subscribe/desktop/global")};n.fetchDndStatus=o;var r=function(e){return i.post("subscribe/desktop/global",{data:{doNotDisturb:e}})};n.saveDndStatus=r;return n});hubspot.define("SignalsExtension/api/FireAlarmApi",["SignalsExtension/api/SidekickHttpClient"],function(e){"use strict";var n={},t=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(n,"__esModule",{value:!0});var i=t(e),o=function(){return i.get("alarm/v1/messages/signals:client:chrome").then(function(e){return e.get("message")})};n.fetchAlarmStatus=o;return n});hubspot.define("SignalsExtension/api/SidekickAppHttpClient",["hub-http","hub-http/adapters/promiseClient","hub-http/middlewares/core","hub-http/middlewares/debug","hub-http-contrib/middlewares/sidekickDefaults","hub-http-contrib/middlewares/immutable"],function(e,n,t,i,o,r){"use strict";var s={},a=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(s,"__esModule",{value:!0});var u=a(n),c=a(o);s=u(e.createStack(t.services,c,t.jsonBody,t.httpsOnly,t.environmentUrl(t.standardApi("app","getsidekick")),t.withQuery,i.rewriteUrl,t.validateStatus,r.immutableResponse));return s});hubspot.define("SignalsExtension/api/SidekickHttpClient",["hub-http","hub-http/adapters/promiseClient","hub-http/middlewares/core","hub-http/middlewares/debug","hub-http-contrib/middlewares/sidekickDefaults","hub-http-contrib/middlewares/immutable"],function(e,n,t,i,o,r){"use strict";var s={},a=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(s,"__esModule",{value:!0});var u=a(n),c=a(o);s=u(e.createStack(t.services,c,t.jsonBody,t.httpsOnly,t.environmentUrl(t.standardApi("api","getsidekick")),t.withQuery,i.rewriteUrl,t.validateStatus,r.immutableResponse));return s});hubspot.define("SignalsExtension/config/buildCdnUrl",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});var n=function(e){return"local"===e?"https://local.hsappstatic.net":"https://static.hsappstatic.net"},t=function(e,t){var i=void 0===arguments[2]?"":arguments[2],o=n(e);return"qa"===e?""+o+t+"-qa"+i:""+o+t+i};e=t;return e});hubspot.define("SignalsExtension/config/context",["enviro","Q","SignalsExtension/globals/location"],function(e,n,t){"use strict";var i={},o=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(i,"__esModule",{value:!0});var r=o(e),s=o(n),a=o(t);r.deployed("q")||(s.longStackSupport=!0);var u="chrome-extension:",c=a.pathname,l=a.protocol,d=l===u&&-1!==c.indexOf("background.html"),f=l===u&&-1!==c.indexOf("popup.html"),g=null;g=d?"background":f?"popup":"content_script";i=g;return i});hubspot.define("SignalsExtension/globals/Raven",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.Raven;return e});hubspot.define("SignalsExtension/globals/chrome",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=chrome;return e});hubspot.define("SignalsExtension/globals/document",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=document;return e});hubspot.define("SignalsExtension/globals/localStorage",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.localStorage;return e});hubspot.define("SignalsExtension/globals/location",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.location;return e});hubspot.define("SignalsExtension/globals/open",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.open;return e});hubspot.define("SignalsExtension/globals/setInterval",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.setInterval;return e});hubspot.define("SignalsExtension/globals/setTimeout",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window.setTimeout;return e});hubspot.define("SignalsExtension/globals/window",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});e=window;return e});hubspot.define("SignalsExtension/constants/InboxSdk",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});var n="sdk_SIDEKICK_ab674cd386";e.APP_ID=n;return e});hubspot.define("SignalsExtension/constants/OnboardingFlows",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});var n={INVITED_PAID:"INVITED_PAID",INAPP_CRM:"INAPP_CRM",INAPP_ACTIVITY_STREAM:"INAPP_ACTIVITY_STREAM"};e=n;return e});hubspot.define("SignalsExtension/constants/Pubnub",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});var n={ACTIVITY:"ACTIVITY",COMMAND:"CHROME_CONTROL",DOMAIN_ROTATION:"DOMAIN_ROTATION"},t={RELOAD:"RELOAD",PICKED_PORTAL_CHANGED:"PICKED_PORTAL_CHANGED"},i="sidekick.chrome.background.pubnub.uuid",o="pubnub/v1/configuration",r=6e4;e={MESSAGE_TYPES:n,COMMAND_TYPES:t,UUID_STORAGE_KEY:i,CONFIG_ENDPOINT:o,ERROR_RETRY_RATE:r};return e});hubspot.define("SignalsExtension/constants/TemplateOnboardingMoleTriggers",[],function(){"use strict";var e={};Object.defineProperty(e,"__esModule",{value:!0});var n="templates-onboarding-modal-trigger:on-page-load",t="templates-onboarding-modal-trigger:on-compose",i="templates-onboarding-modal-trigger:on-send",o="NONE";e={ON_PAGE_LOAD:n,ON_COMPOSE:t,ON_SEND:i,NONE:o};return e});hubspot.define("SignalsExtension/init/Background",["SignalsExtension/background/browserAction","sidekick.chrome.common.utils.hubSpotApi","SignalsExtension/background/accountManager","sidekick.chrome.background.requestBlocker","sidekick.chrome.trackerSaver","SignalsExtension/background/notifications/manager","sidekick.chrome.background.updateManager","sidekick.chrome.backbone.models.domainRotations","SignalsExtension/background/startHublyticsListener","SignalsExtension/background/startRemoteAssetUpdateListener","SignalsExtension/utils/RemoteAssets","SignalsExtension/utils/loadJS","SignalsExtension/background/notifications/activityHandlerRegistration","SignalsExtension/data/firstRunTracker","SignalsExtension/background/extensionActions"],function(e,n,t,i,o,r,s,a,u,c,l,d,f,g,b){"use strict";var p={},m=function(e){return e&&e.__esModule?e["default"]:e},h=m(e),v=m(n),k=m(t),S=m(i),_=m(o),E=m(s),x=m(a),y=m(u),A=m(c),M=m(d),O=m(f),P=m(b);hubspot.require(["sidekick.chrome.userData","sidekick.chrome.utils.console","sidekick.chrome.utils.http","sidekick.chrome.utils.sidekickApi","sidekick.chrome.utils.matchers","sidekick.chrome.backbone.models.user","sidekick.chrome.backbone.models.options"]);y();A();g.initFirstRunTracker();P.init();h.init();k.init();S.init();_.init();x.fetch();r.init();v.get().refreshAuthToken();E.start();O();l.loadBackgroundRemoteAssets(M).then(function(){hubspot.require(["SalesExtensionRemoteAssets/background/init"],function(e){return e()})}).done();return p});hubspot.define("SignalsExtension/init/Gmail",["SignalsExtension/utils/extensionManager","InboxSDK","SignalsExtension/constants/InboxSdk","SignalsExtension/utils/RemoteAssets","SignalsExtension/data/requestIdlePermission","SignalsExtension/globals/document","SignalsExtension/utils/inboxSDKLoadJS","SignalsExtension/globals/window"],function(e,n,t,i,o,r,s,a){"use strict";var u={},c=function(e){return e&&e.__esModule?e["default"]:e},l=c(e),d=c(n),f=c(o),g=c(r),b=c(s),p=c(a),m=function(){return d.load("1",t.APP_ID).then(function(e){return i.loadGmailRemoteAssets(b).then(function(){hubspot.require(["SalesExtensionRemoteAssets/gmail/init"],function(n){return n(e)})})})};if(p.self===p.top){l.connect().then(m).done();g.addEventListener("DOMContentLoaded",f)}return u});hubspot.define("SignalsExtension/init/Inbox",["SignalsExtension/utils/extensionManager","InboxSDK","SignalsExtension/constants/InboxSdk","SignalsExtension/utils/RemoteAssets","SignalsExtension/data/requestIdlePermission","SignalsExtension/globals/document","SignalsExtension/utils/inboxSDKLoadJS"],function(e,n,t,i,o,r,s){"use strict";var a={},u=function(e){return e&&e.__esModule?e["default"]:e},c=u(e),l=u(n),d=u(o),f=u(r),g=u(s),b=function(){return l.load("2",t.APP_ID).then(function(e){return i.loadInboxRemoteAssets(g).then(function(){return hubspot.require(["SalesExtensionRemoteAssets/inbox/init"],function(n){return n(e)})})})};c.connect().then(b).done();f.addEventListener("DOMContentLoaded",d);return a});hubspot.define("SignalsExtension/init/Popup",["_","Kefir","sidekick.chrome.backbone.models.options","SignalsExtension/background/accountManager","SignalsExtension/background/browserAction","sidekick.chrome.background.notifications.doNotDisturb","sidekick.chrome.common.utils.hubSpotApi","urlinator/Url"],function(e,n,t,i,o,r,s,a){"use strict";var u={},c=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(u,"__esModule",{value:!0});var l=c(t),d=c(o),f=c(r),g=c(s),b=c(a),p=function(t){var o=t.document,r=t.window,s=n.fromEvents(r,"message").filter(function(e){if(!e.data)return!1;var n=e.data,t=n.sender,i=n.type;return"ACTIVITY_FEED"===t&&"DO_NOT_DISTURB"===i}),a=function(n,t){var i=o.querySelector("#firealarm"),r=i.querySelector("#firealarm-msg");if(n){i.style.display="";r.innerHTML=t;e.each(r.querySelectorAll("a:link"),function(e){e.target="_blank"})}else i.style.display="none"},u=function(e){return d.checkAlarm()["finally"](function(){d.updateIcon(e);a(l.hasAlarm(),l.getAlarmStatus())})};d.clearBadge();var c=function(e){var n=new b(e,{lb:"app",protocol:"https"}).href;o.querySelector("#streamIframe iframe").src=n};i.checkLoggedIn(function(e){u(e);d.updateIcon(e);e?g.get().getPortalId().then(function(e){c("/sales-notifications-embedded/"+e+"/all?source=extension")}).done():c("/sales-notifications-embedded?source=extension")});s.onValue(function(e){var n=e.data.content;f.set(n.doNotDisturb);d.updateIcon(!0)})};u.init=p;return u});hubspot.define("SignalsExtension/utils/RemoteAssets",["enviro","SignalsExtension/utils/loadCss","SignalsExtension/config/buildCdnUrl","sidekick.chrome.utils.console"],function(e,n,t,i){"use strict";var o={},r=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(o,"__esModule",{value:!0});var s=r(e),a=r(n),u=r(t),c=r(i),l=function(e){c.debug("Loading remote Background assets");var n=u(s.getShort("REMOTE_ASSETS"),"/SalesExtensionRemoteAssets/ex/background",".js");return e(n)};o.loadBackgroundRemoteAssets=l;var d=function(e){c.debug("Loading remote Gmail assets");var n=u(s.getShort("REMOTE_ASSETS"),"/SalesExtensionRemoteAssets/ex/gmail",".css"),t=u(s.getShort("REMOTE_ASSETS"),"/SalesExtensionRemoteAssets/ex/gmail",".js");a(n);return e(t)};o.loadGmailRemoteAssets=d;var f=function(e){c.debug("Loading remote Inbox assets");var n=u(s.getShort("REMOTE_ASSETS"),"/SalesExtensionRemoteAssets/ex/inbox",".css"),t=u(s.getShort("REMOTE_ASSETS"),"/SalesExtensionRemoteAssets/ex/inbox",".js");a(n);return e(t)};o.loadInboxRemoteAssets=f;return o});hubspot.define("SignalsExtension/utils/contentScriptMessaging",["sidekick.chrome.utils.console","SignalsExtension/globals/chrome"],function(e,n){"use strict";var t={},i=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(t,"__esModule",{value:!0});var o=i(e),r=i(n),s=function(e,n){r.runtime.sendMessage({method:e,data:n})};t.sendToBackground=s;var a=function(e,n,t){var i=function(i,r){if(null==r.tab&&i.method===e)try{n.apply(t,[i.data])}catch(s){o.error(s);o.info(e);o.debug(i.data);o.debug(t)}};r.runtime.onMessage.addListener(i)};t.listenToBackground=a;return t});hubspot.define("SignalsExtension/utils/extensionManager",["Q","_","SignalsExtension/globals/chrome","sidekick.chrome.backbone.models.user"],function(e,n,t,i){"use strict";var o={},r=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(o,"__esModule",{value:!0});var s=r(n),a=r(t),u=r(i),c={attempts:0,deferred:e.defer(),active:!1},l=null,d=function(){if(c.active)return c.deferred.promise;l=a.runtime.connect();l.onDisconnect.addListener(f);l.onMessage.addListener(b);c.active=!0;return c.deferred.promise},f=function(){c.active=!1;c.attempts=c.attempts+1;c.attempts<20?s.delay(d,1e3):s.delay(d,1e4)},g=function(e){l.onDisconnect.removeListener(f);u.set(e.user_profile,{ext_sync:!0});c.deferred.resolve()},b=function(e){switch(e.method){case"userModel":g(e)}};o={connect:d};return o});hubspot.define("SignalsExtension/utils/getChromeVersion",["SignalsExtension/globals/window"],function(e){"use strict";var n={},t=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(n,"__esModule",{value:!0});var i=t(e),o=function(){return parseInt(i.navigator.appVersion.match(/Chrome\/(\d+)\./)[1],10)};n=o;return n});hubspot.define("SignalsExtension/utils/inboxSDKLoadJS",["InboxSDK"],function(e){"use strict";var n={},t=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(n,"__esModule",{value:!0});var i=t(e);n=function(e){return i.loadScript(e,{nowrap:!0})};return n});hubspot.define("SignalsExtension/utils/loadCss",["Q","SignalsExtension/globals/document"],function(e,n){"use strict";var t={},i=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(t,"__esModule",{value:!0});var o=i(e),r=i(n),s=function(e){return o.promise(function(n,t){var i=r.createElement("link");i.rel="stylesheet";i.type="text/css";i.onload=function(){return n()};i.onerror=function(){return t()};i.href=e;r.head.appendChild(i)})};t=s;return t});hubspot.define("SignalsExtension/utils/loadJS",["Q"],function(e){"use strict";var n={};Object.defineProperty(n,"__esModule",{value:!0});n=function(n){return e.promise(function(e,t){var i=document.createElement("script");i.src=n;document.body.appendChild(i);i.onload=function(){return e()};i.onerror=function(){return t()}})};return n});hubspot.define("SignalsExtension/utils/onSidekickCookieChanged",["_","enviro","SignalsExtension/globals/chrome","sidekick.chrome.constants.cookieDescriptors"],function(e,n,t,i){"use strict";var o={},r=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(o,"__esModule",{value:!0});var s=r(n),a=r(t);o=function(n,t){a.cookies.onChanged.addListener(function(o){var r=o.cookie,a=i.SIDEKICK_COOKIE[s.getShort("api")],u=e.str.include(r.domain,a.domain);u&&r.name===n&&t(o)})};return o});hubspot.define("SignalsExtension/utils/tabs",["enviro","SignalsExtension/globals/chrome","SignalsExtension/globals/setTimeout"],function(e,n,t){"use strict";var i={},o=function(e){return e&&e.__esModule?e["default"]:e};Object.defineProperty(i,"__esModule",{value:!0});var r=o(e),s=o(n),a=o(t),u=function(e,n){s.tabs.query({},function(t){var i=!0,o=!1,r=void 0;try{for(var s,a=Array.from(t)[Symbol.iterator]();!(i=(s=a.next()).done);i=!0){var u=s.value;(null==e||-1!==u.url.indexOf(e))&&n(u)}}catch(c){o=!0;r=c}finally{try{!i&&a["return"]&&a["return"]()}finally{if(o)throw r}}})},c=function(e,n){return u(n,function(n){"close"===e?s.tabs.remove(n.id):"reload"===e&&s.tabs.reload(n.id)})},l=function(){var e=r.isProd()?"getsidekick.com":"getsidekickqa.com";c("close",e)},d=function(){l();var e=s.runtime.reload;a(e,500)},f=function(){return c("reload","mail.google.com")},g=function(e){return s.tabs.create({url:e,index:1e3})},b=function(e){return s.tabs.query({active:!0},function(n){return s.tabs.update(n.id,{url:e})})};i={restartExtension:d,reloadGmailTabs:f,closeTabs:c,openNewTab:g,openInActiveTab:b,forAllTabs:u};return i});